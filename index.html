<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>uDOM Architecture - Visual & Structural Knowledge for Agents</title>
    <meta name="description" content="Universal structural knowledge for design agents. Capture design artifacts, workspace tools, and procedural workflows with uDOM snapshots, UAT temporal graphs, and collective databases.">
    <meta name="keywords" content="uDOM, design agents, structural knowledge, design systems, Figma, React, HTML, design-to-code, component retrieval">
    <meta property="og:title" content="uDOM Architecture - Visual & Structural Knowledge for Agents">
    <meta property="og:description" content="Universal structural knowledge for design agents. Capture design artifacts, workspace tools, and procedural workflows.">
    <meta property="og:type" content="website">
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="uDOM Architecture">
    <meta name="twitter:description" content="Universal structural knowledge for design agents">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap">
    <style>
        /* Critical CSS Variables - Embedded for Netlify/CDN reliability */
        :root {
            --font-display: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            --font-body: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Helvetica Neue', Arial, sans-serif;
            --font-mono: 'SF Mono', 'Monaco', 'Cascadia Code', 'Courier New', monospace;
            --weight-light: 300;
            --weight-normal: 400;
            --weight-medium: 500;
            --weight-semibold: 600;
            --weight-bold: 700;
            --size-xs: 11px;
            --size-sm: 13px;
            --size-base: 15px;
            --size-lg: 18px;
            --size-xl: 24px;
            --size-2xl: 36px;
            --size-3xl: 56px;
            --size-4xl: 72px;
            --color-theme-fg: #26251e;
            --color-theme-card-hex: #f2f1ed;
            --color-theme-border-02: #26251e1a;
            --bg-primary: #ffffff;
            --bg-secondary: #f2f1ed;
            --bg-tertiary: #ebeae5;
            --text-primary: #26251e;
            --text-secondary: #26251e99;
            --text-tertiary: #26251e66;
            --border: #26251e1a;
            --border-subtle: #26251e06;
            --accent: #f54e00;
            --accent-hover: #d94500;
            --space-0: 0;
            --space-1: 4px;
            --space-2: 8px;
            --space-3: 12px;
            --space-4: 16px;
            --space-5: 20px;
            --space-6: 24px;
            --space-8: 32px;
            --space-10: 40px;
            --space-12: 48px;
            --space-16: 64px;
            --radius-sm: 4px;
            --radius-md: 6px;
            --radius-lg: 8px;
            --transition-base: 0.2s ease;
        }
        /* Ensure proper layout when CSS files don't load */
        body {
            margin: 0;
            padding: 0;
            font-family: var(--font-body);
            background: var(--bg-primary);
            color: var(--text-primary);
            line-height: 1.6;
            min-height: 100vh;
        }
    </style>
    <link rel="stylesheet" href="design-system.css">
    <link rel="stylesheet" href="assets/css/styles.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/styles/github.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/highlight.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/json.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/typescript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.9.0/languages/sql.min.js"></script>
</head>
<body>
    <!-- Mobile Sidebar Toggle -->
    <button class="sidebar-toggle" id="sidebar-toggle" aria-label="Toggle navigation menu">
        <span></span>
        <span></span>
        <span></span>
    </button>
    
    <!-- Sidebar Navigation -->
<nav class="sidebar" id="sidebar">
    <div class="sidebar-header">
        <div class="sidebar-title">uDOM Architecture</div>
        <div class="sidebar-subtitle">Universal structural knowledge for design agents</div>
    </div>

    <!-- GETTING STARTED -->
    <div class="nav-section">
        <div class="nav-section-title">Getting Started</div>
        <a href="#" class="nav-item" onclick="showSection(event, 'getting-started')"
           data-tooltip="Quick start, plugin setup, and sample data browser" aria-label="Getting Started">Getting Started</a>
    </div>

    <!-- OVERVIEW -->
    <div class="nav-section">
        <div class="nav-section-title">Overview</div>
        <a href="#" class="nav-item active" onclick="showSection(event, 'overview')" 
           data-tooltip="Introduction to uDOM architecture, principles, and system goals"
           aria-label="Introduction">Introduction</a>
        <a href="#" class="nav-item" onclick="showSection(event, 'data-flow')"
           data-tooltip="End-to-end data flow from extraction to storage and querying" aria-label="Data Flow">Data Flow</a>
        <a href="#" class="nav-item" onclick="showSection(event, 'hierarchy')"
           data-tooltip="Complete uDOM schema hierarchy showing all fields and relationships" aria-label="Hierarchy">Schema Hierarchy</a>
    </div>

    <!-- SCHEMA -->
    <div class="nav-section">
        <div class="nav-section-title">Schema</div>
        <a href="#" class="nav-item" onclick="showSection(event, 'schema-details')"
           data-tooltip="Core fields, fidelity targets, and schema versioning" aria-label="Schema Details">Schema Details</a>
        <a href="#" class="nav-item" onclick="showSection(event, 'examples')"
           data-tooltip="Figma, React, and comparison examples" aria-label="Examples">Examples</a>
    </div>

    <!-- REFERENCE -->
    <div class="nav-section">
        <div class="nav-section-title">Reference</div>
        <a href="#" class="nav-item" onclick="showSection(event, 'reference')"
           data-tooltip="Artifact types, extraction methods, and quality guide" aria-label="Reference">Reference</a>
    </div>

    <!-- ARCHITECTURE: System Design (split into two logical groups) -->
    <div class="nav-section">
        <div class="nav-section-title">Architecture</div>
        <a href="#" class="nav-item" onclick="showSection(event, 'visual-diagrams')"
           data-tooltip="Visual diagrams showing uDOM vs UAT vs DB, contributor architecture, and capture layers" aria-label="Visual Diagrams">Diagrams</a>
        <a href="#" class="nav-item" onclick="showSection(event, 'storage-strategy')"
           data-tooltip="How artifact_type determines storage backend selection" aria-label="Storage">Storage Strategy</a>
        <a href="#" class="nav-item" onclick="showSection(event, 'contributor-architecture')"
           data-tooltip="Multi-contributor system: demographics, subgraph querying, privacy controls" aria-label="Contributors">Contributors</a>
        <a href="#" class="nav-item" onclick="showSection(event, 'datasette-integration')"
           data-tooltip="Exploration and querying layer for uDOM snapshots using Datasette" aria-label="Datasette">Datasette</a>
        <a href="#" class="nav-item" onclick="showSection(event, 'precedent-schemas')"
           data-tooltip="Comparison with existing standards (DOM, PROV-O, Design Tokens, etc.)" aria-label="Precedents">Precedents</a>
    </div>

    <!-- RESEARCH: ML & Advanced -->
    <div class="nav-section">
        <div class="nav-section-title">Research</div>
        <a href="#" class="nav-item" onclick="showSection(event, 'training-use-cases')"
           data-tooltip="ML training scenarios and model architectures enabled by uDOM" aria-label="Training Use Cases">Training Use Cases</a>
        <a href="#" class="nav-item" onclick="showSection(event, 'related-work')"
           data-tooltip="Research context: embedding inversion, design-to-code, component retrieval" aria-label="Related Work">Related Work</a>
        <a href="https://earnest-lebkuchen-7c5a3e.netlify.app/rl-docs" class="nav-item" target="_blank" rel="noopener noreferrer"
           data-tooltip="Intent Rule Learning system documentation and constitutional principles" aria-label="RL System">RL System</a>
    </div>

    <!-- HELP -->
    <div class="nav-section">
        <div class="nav-section-title">Help</div>
        <a href="#" class="nav-item" onclick="showSection(event, 'help')"
           data-tooltip="FAQ and how to get involved" aria-label="Help">Help & Support</a>
    </div>
</nav>


    <!-- Main Content -->
    <main class="main-content">
<section id="overview" class="section active">
            <h1>uDOM: Universal Structural Awareness for Agents</h1>
            <p class="subtitle">A unified schema for capturing design artifacts across tools. Three layers: <strong>uDOM</strong> (snapshots), <strong>UAT</strong> (temporal graphs), <strong>DB</strong> (collective database). Structural state and procedural actions are captured separately. Includes intent capture, preference learning, and smart design suggestions.</p>

            <h2>Design Goals</h2>
            <p><strong>Streamable</strong> (MCP protocols) • <strong>Referential</strong> (content-addressable IDs) • <strong>Extensible</strong> (properties{} for artifact-specific fields) • <strong>Queryable</strong> (SQL, graph, vector) • <strong>Private</strong> (omit raw content, include only hashes) • <strong>Composable</strong> (elements → components → artifacts)</p>

            <h2>Three Layers</h2>
            <div class="example-box">
                <p><strong>uDOM:</strong> Single snapshot (elements + relations + metadata)</p>
                <p><strong>UAT:</strong> Materialized view over snapshots aligned by artifact_id, timestamp, or stable_id</p>
                <p><strong>DB:</strong> Collection of UATs + indices + cross-artifact links</p>
                <p><em>Snapshots are indexed observations, not versions.</em></p>
            </div>

            <h2>Two Capture Types</h2>
            <div class="card-grid">
                <div class="card">
                    <h4>Structural (Artifact Adapter)</h4>
                    <p>Snapshots of <strong>what exists</strong><br/>elements → components → artifacts</p>
                </div>
                <div class="card">
                    <h4>Procedural (Procedural Adapter)</h4>
                    <p>Events of <strong>what happened</strong><br/>actions → steps → workflows</p>
                </div>
            </div>
            <p><em>Procedures reference uDOM elements via stable IDs. These dimensions intersect by reference, not inheritance.</em></p>

            <h2>Data Flow Phases</h2>
            <div class="example-box">
                <p><strong>Key principle:</strong> uDOM snapshots are indexed observations, not versions; UATs are constructed views that align snapshots along chosen dimensions.</p>
            </div>
            <div class="flow-container">
                <div class="flow-step">
                    <div class="flow-box flow-input">Workspace / Tool</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">Adapter<small>(platform-specific)</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">uDOM Snapshot<small>indexed by:<br/>• artifact_id<br/>• artifact_type<br/>• capture_context<br/>• timestamp</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-storage">Snapshot Store<small>(DB: Document/Columnar/Graph/Vector)</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-decision">Alignment / Indexing<small>(constructs UATs)</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">UATs<small>(materialized views)</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-query">Query Layer</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">Agents & Models</div>
                </div>
            </div>

            <h2>Adapters</h2>
            <div class="example-box">
                <p><strong>Adapters translate tool-specific formats to universal uDOM.</strong></p>
                <ol>
                    <li>Select component in tool (Figma, React, HTML)</li>
                    <li>Adapter reads native properties</li>
                    <li>Adapter translates to uDOM structure</li>
                    <li>Adapter sends to database</li>
                    <li>Database stores for query/analysis</li>
                </ol>
            </div>
            
            <div class="flow-container">
                <div class="flow-step">
                    <div class="flow-box flow-input">Tool</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">Adapter<small>Extract & translate</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">uDOM<small>Universal format</small></div>
                </div>
            </div>


            <h2>Demo Architecture (End-to-End)</h2>
            <div class="flow-container">
                <div class="flow-step">
                    <div class="flow-box flow-input">Tool / Workspace</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">Artifact Adapter</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">uDOM Snapshots</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-storage">SQLite DB</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-decision">UAT Construction<small>From stored snapshots</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-query">Datasette<small>Web UI + SQL + JSON API</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">Agents</div>
                </div>
                <div class="flow-step flow-step-spaced">
                    <div class="flow-box flow-input">Tool / Workspace</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">Procedural Adapter</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-input">Procedure Events<small>References uDOM elements<br/>via stable IDs</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-query">MCP Stream<small>Real-time streaming</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">Agents</div>
                </div>
            </div>
            <div class="example-box example-box-spaced">
                <p><em>Note: Structural capture (uDOM) and procedural capture (events) are separate parallel streams that reference each other via stable IDs.</em></p>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h4>Explore with Datasette</h4>
                    <p>Query snapshots via SQL or browse in web UI:</p>
                    <pre>datasette snapshots.db --port 8000
# Browse: http://localhost:8000</pre>
                </div>
                <div class="card">
                    <h4>Example Query</h4>
                    <pre>SELECT 
  artifact_id,
  json_extract(udom_data, 
    '$.elements[0].semantic_type') 
    as element_type
FROM snapshots
WHERE artifact_type = 'figma_component'</pre>
                </div>
            </div>


            <h2>Capture Triggers</h2>
            <p><strong>Snapshots</strong>: Focus shift, save, component switch<br/>
            <strong>Events</strong>: All actions, grouped by edit context</p>

            <h2>Core Concepts</h2>
            <p><strong>artifact_type</strong>: Root discriminator (figma_component, react_component, etc.)<br/>
            <strong>stable_id</strong>: Content-addressable identifier<br/>
            <strong>observations{}</strong>: Provenance metadata (who, when, how) + intent data<br/>
            <strong>UAT</strong>: Materialized view over snapshots<br/>
            <strong>Adapter</strong>: Tool-specific translator to uDOM<br/>
            <strong>Intent</strong>: User goals captured in snapshots (e.g., "make this more premium")<br/>
            <strong>Preferences</strong>: Accept/reject feedback that trains suggestion quality</p>
            
            <h2>Design Suggestions & Preferences</h2>
            <div class="card-grid">
                <div class="card">
                    <h4>Smart Suggestions</h4>
                    <p>One-click design improvements based on snapshot context. Intent inferred automatically from design state and user actions.</p>
                </div>
                <div class="card">
                    <h4>Auto-Apply</h4>
                    <p>Simple changes (typography, spacing) applied automatically. Complex changes show interactive walkthrough.</p>
                </div>
                <div class="card">
                    <h4>Preference Learning</h4>
                    <p>Accept/reject feedback improves future suggestions through preference-based ranking and constitutional principles.</p>
                </div>
            </div>
        </section>
        </section><section id="getting-started" class="section">
    <h1>Getting Started with uDOM</h1>
    <p class="subtitle">Quick start guide and plugin setup instructions</p>

    <!-- Tab Navigation -->
    <div class="tab-container">
        <div class="tab-buttons">
            <button class="tab-btn active" onclick="switchTab(event, 'getting-started', 'quickstart')" aria-label="Quick Start">Quick Start</button>
            <button class="tab-btn" onclick="switchTab(event, 'getting-started', 'plugin-setup')" aria-label="Plugin Setup">Plugin Setup</button>
            <button class="tab-btn" onclick="switchTab(event, 'getting-started', 'sample-data')" aria-label="Sample Data">Sample Data Browser</button>
        </div>

        <!-- Quick Start Tab -->
        <div id="getting-started-tab-quickstart" class="tab-content active">
            <h2>Quick Start</h2>
            <p>The fastest way to understand uDOM is to capture snapshots from your Figma components and explore them in the sample data browser.</p>

            <div class="card-grid">
                <div class="card">
                    <h4>1. Run Database Server</h4>
                    <pre>cd udom-server
npm install
npm start</pre>
                    <p>Server runs on <code>http://localhost:3000</code></p>
                    <p>Viewer: <code>http://localhost:3000/viewer</code></p>
                </div>
                <div class="card">
                    <h4>2. Load Figma Plugin</h4>
                    <pre>cd figma-plugin
npm install
npm run build
./start-servers.sh</pre>
                    <p>Load in Figma Desktop: Plugins > Development > Import plugin</p>
                </div>
                <div class="card">
                    <h4>3. Get Design Suggestions</h4>
                    <p>Select a component → Click "Get Suggestions" → Accept/reject to improve future suggestions</p>
                    <p>View analytics at <code>http://localhost:3000/viewer</code></p>
                </div>
            </div>

            <h3>Authentication & Multi-Contributor System</h3>
            <div class="example-box">
                <p><strong>Authentication is adapter-specific:</strong> Each adapter handles its own authentication (Figma OAuth, GitHub tokens, etc.). uDOM stores the authentication result in <code>observations.provenance</code>, not credentials.</p>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Adapter</th>
                        <th>Authentication Method</th>
                        <th>What's Stored</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>Figma Plugin</td>
                        <td>Figma OAuth (automatic)</td>
                        <td><code>user_id</code>, <code>user_name</code>, <code>workspace_id</code></td>
                    </tr>
                    <tr>
                        <td>GitHub Adapter</td>
                        <td>GitHub Personal Access Token</td>
                        <td><code>user_id</code>, <code>repo_id</code>, <code>commit_sha</code></td>
                    </tr>
                    <tr>
                        <td>Browser Extension</td>
                        <td>No auth (local capture)</td>
                        <td><code>session_id</code>, <code>url</code>, <code>timestamp</code></td>
                    </tr>
                </tbody>
            </table>

            <h3>Next Steps</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Install Plugin</h4>
                    <p>See the Plugin Setup tab for detailed instructions on installing and using the Figma plugin.</p>
                </div>
                <div class="card">
                    <h4>Explore Data</h4>
                    <p>Use the Sample Data Browser tab to query and visualize captured snapshots.</p>
                </div>
                <div class="card">
                    <h4>Read Docs</h4>
                    <p>Visit the Overview section to understand the uDOM architecture and schema.</p>
                </div>
            </div>
        </div>

        <!-- Plugin Setup Tab -->
        <div id="getting-started-tab-plugin-setup" class="tab-content">
            <h2>Figma Plugin Setup</h2>
            <p>Complete setup and usage guide for the uDOM Figma plugin</p>

            <h3>Prerequisites</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Required</h4>
                    <ul>
                        <li>Figma Desktop App (plugins require desktop)</li>
                        <li>Node.js 18+ installed</li>
                        <li>Database server running (see Quick Start)</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Optional</h4>
                    <ul>
                        <li>Datasette for data exploration</li>
                        <li>MCP server for procedural capture</li>
                    </ul>
                </div>
            </div>

            <h3>Installation Steps</h3>
            <div class="example-box">
                <h4>1. Install Dependencies</h4>
                <pre>cd figma-plugin
npm install</pre>

                <h4>2. Build Plugin</h4>
                <pre>npm run build</pre>
                <p>This compiles TypeScript and bundles the plugin code into <code>code.js</code>.</p>

                <h4>3. Load in Figma</h4>
                <ol>
                    <li>Open Figma Desktop App</li>
                    <li>Go to <strong>Plugins → Development → Import plugin from manifest...</strong></li>
                    <li>Select the <code>figma-plugin</code> folder</li>
                    <li>Click "Save" to load the plugin</li>
                </ol>

                <h4>4. Run Plugin</h4>
                <ol>
                    <li>Select a component or frame in Figma</li>
                    <li>Go to <strong>Plugins → Development → uDOM Capture</strong></li>
                    <li>Click "Capture Snapshot" in the plugin UI</li>
                    <li>Snapshot is sent to local database server</li>
                </ol>
            </div>

            <h3>What Gets Captured</h3>
            <div class="example-box">
                <ul>
                    <li><strong>Structure:</strong> Component hierarchy, element types, parent-child relations</li>
                    <li><strong>Properties:</strong> Dimensions, layout mode, padding, spacing, corner radius</li>
                    <li><strong>Visual:</strong> Fills, strokes, effects, shadows</li>
                    <li><strong>Text:</strong> Content, font family, size, weight, line height</li>
                    <li><strong>Spatial:</strong> Absolute coordinates, relative layout information</li>
                    <li><strong>Metadata:</strong> Component name, Figma node ID, stable content-addressable ID</li>
                </ul>
            </div>

            <h3>Development Mode</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Watch Mode</h4>
                    <pre>npm run watch</pre>
                    <p>Automatically rebuilds on file changes</p>
                </div>
                <div class="card">
                    <h4>Type Checking</h4>
                    <pre>npx tsc --noEmit</pre>
                    <p>Check TypeScript errors without building</p>
                </div>
            </div>

            <h3>Troubleshooting</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Plugin Won't Load</h4>
                    <ul>
                        <li>Ensure Figma Desktop (not web)</li>
                        <li>Check <code>code.js</code> exists</li>
                        <li>Run <code>npm run build</code></li>
                        <li>Check console for errors</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Connection Failed</h4>
                    <ul>
                        <li>Verify server: <code>curl http://localhost:3000/health</code></li>
                        <li>Check firewall settings</li>
                        <li>Ensure manifest allows localhost</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Capture Fails</h4>
                    <ul>
                        <li>Check server logs for errors</li>
                        <li>Verify database is writable</li>
                        <li>Ensure valid component/frame selected</li>
                        <li>Check plugin UI console</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Sample Data Browser Tab -->
        <div id="getting-started-tab-sample-data" class="tab-content">
            <h2>Sample Data Browser</h2>
            <p>Query and explore captured uDOM snapshots directly from the local database</p>

            <div class="data-browser-controls">
                <div class="filter-group">
                    <label for="artifact-type-filter">Artifact Type:</label>
                    <select id="artifact-type-filter">
                        <option value="">All Types</option>
                        <option value="figma_component">Figma Component</option>
                        <option value="react_component">React Component</option>
                        <option value="html_element">HTML Element</option>
                    </select>
                </div>
                <button class="btn-primary" onclick="loadSampleData()">Load Snapshots</button>
                <button class="btn-secondary" onclick="clearSampleDataResults()">Clear</button>
            </div>

            <div id="sample-data-results"></div>

            <div class="example-box">
                <h3>Exploring with Datasette (Recommended)</h3>
                <p>For a richer exploration experience with SQL queries and JSON API:</p>
                <pre>cd udom-server
pip install datasette
datasette snapshots.db --port 8000 --cors</pre>
                <p>Then browse at <code>http://localhost:8000</code></p>
            </div>
        </div>
    </div>
</section>

<section id="hierarchy" class="section">
            <h1>Complete uDOM Hierarchy</h1>
    <p class="subtitle">Interactive tree representation showing all fields, their relationships, and extensibility points. Click the Info buttons to see examples, toggle sections to expand/collapse, and filter by artifact type.</p>

    <div class="hierarchy-controls">
        <div class="artifact-type-selector">
            <label>View for artifact type:</label>
            <select id="artifact-type-filter" onchange="filterHierarchyByType(this.value)">
                <option value="all">All Types (Baseline)</option>
                <option value="figma_component">Figma Component</option>
                <option value="react_component">React Component</option>
                <option value="html_element">HTML Element</option>
                <option value="sketch_artboard">Sketch Artboard</option>
            </select>
        </div>
        <button class="expand-all-btn" onclick="expandAllHierarchy()" aria-label="Expand all hierarchy nodes">Expand All</button>
        <button class="collapse-all-btn" onclick="collapseAllHierarchy()" aria-label="Collapse all hierarchy nodes">Collapse All</button>
    </div>

    <div class="interactive-tree" id="hierarchy-tree">
        <div class="tree-node root-node expanded" data-field="root">
            <div class="tree-node-header" onclick="toggleNode(this)">
                <span class="tree-toggle"></span>
                <span class="tree-root">uDOM</span>
                <span class="tree-comment">(Universal DOM - Root Schema)</span>
                <button class="tree-toggle-info" 
                        data-examples='{"all": "Complete uDOM snapshot structure. Contains metadata, elements array, relations array, and optional observations/composition/rendering fields."}'
                        data-field="root"
                        aria-label="Show information about uDOM root"
                        title="Click to show example" aria-label="Show information" title="Click to show example">
                    <span class="info-icon">i</span>
                </button>
            </div>
            <div class="tree-node-children">
                
                <!-- metadata -->
                <div class="tree-node expanded" data-field="metadata" data-expandable="true">
                    <div class="tree-node-header" onclick="toggleNode(this)">
                        <span class="tree-toggle"></span>
                        <span class="tree-key">metadata</span>
                        <span class="tree-comment">(Snapshot identity & classification)</span>
                        <button class="tree-toggle-info" 
                              data-examples='{"all": "Identifies the snapshot: unique ID, artifact reference, type discriminator, timestamp, content hash, and schema version. artifact_type determines which schema extensions apply."}' aria-label="Show information" title="Click to show example">
                            <span class="info-icon">i</span>
                        </button>
                    </div>
                    <div class="tree-node-children">
                        <div class="tree-leaf" 
                             data-field="snapshot_id"
                             data-examples='{"all": "Unique UUID for this snapshot. Example: \"550e8400-e29b-41d4-a716-446655440000\""}'>
                            <span class="tree-indent"></span>snapshot_id <span class="tree-comment">(UUID)</span>
                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                        </div>
                        <div class="tree-leaf" 
                             data-field="artifact_id"
                             data-examples='{"all": "Global identifier for the artifact. Examples: \"figma://file/abc123/component/xyz\" (Figma), \"file:///src/components/Button.tsx\" (React), \"https://example.com/page#button-1\" (HTML)"}'>
                            <span class="tree-indent"></span>artifact_id <span class="tree-comment">(global identifier)</span>
                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                        </div>
                        <div class="tree-leaf highlight-field" 
                             data-field="artifact_type"
                             data-examples='{"all": "Root discriminator that determines schema extensions. Values: \"figma_component\", \"react_component\", \"html_element\", \"png_image\", etc. This field controls which properties are available in elements[].properties."}'>
                            <span class="tree-indent"></span><span class="tree-star">artifact_type [KEY]</span> <span class="tree-comment">- DETERMINES SCHEMA VARIATION</span>
                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                        </div>
                        <div class="tree-leaf" 
                             data-field="timestamp"
                             data-examples='{"all": "Unix timestamp (milliseconds) for ordering snapshots. Example: 1704067200000. Used for temporal queries, not identity."}'>
                            <span class="tree-indent"></span>timestamp
                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                        </div>
                        <div class="tree-leaf" 
                             data-field="content_hash"
                             data-examples='{"all": "Content-addressable hash (SHA-256) of snapshot content. Example: \"sha256:abc123def456...\". Used for deduplication and stable references."}'>
                            <span class="tree-indent"></span>content_hash
                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                        </div>
                        <div class="tree-leaf" 
                             data-field="schema_version"
                             data-examples='{"all": "uDOM schema version (systematic across all adapters). Example: \"1.0.0\". Different from extractor_version which is adapter-specific."}'>
                            <span class="tree-indent"></span>schema_version
                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                        </div>
                    </div>
                </div>

                <!-- elements[] -->
                <div class="tree-node expanded" data-field="elements" data-expandable="true">
                    <div class="tree-node-header" onclick="toggleNode(this)">
                        <span class="tree-toggle"></span>
                        <span class="tree-key">elements[]</span>
                        <span class="tree-comment">(Element nodes - EXTENSIBLE LIST)</span>
                        <button class="tree-toggle-info" 
                              data-examples='{"all": "Array of element nodes representing the structural components. Each element has id, stable_id, type (varies by artifact_type), semantic_type (universal), and extensible properties."}' aria-label="Show information" title="Click to show example">
                            <span class="info-icon">i</span>
                        </button>
                    </div>
                    <div class="tree-node-children">
                        <div class="tree-node expanded" data-field="element-base" data-expandable="true">
                            <div class="tree-node-header" onclick="toggleNode(this)">
                                <span class="tree-toggle"></span>
                                <span>Element (Base)</span>
                                <span class="tree-comment">(Common fields for all elements)</span>
                            </div>
                            <div class="tree-node-children">
                                <div class="tree-leaf" 
                                     data-field="id"
                                     data-examples='{"all": "\"node-123\"", "figma_component": "\"I123:456;789:0\"", "react_component": "\"Button\"", "html_element": "\"button-1\""}'>
                                    <span class="tree-indent"></span>id <span class="tree-comment">(source-specific)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" 
                                     data-field="stable_id"
                                     data-examples='{"all": "Content-addressable identifier derived from element properties (type, name, dimensions, visual properties). Format: \"content-sha256:abc123def456...\". Same content = same stable_id across platforms, enabling cross-artifact linking. Example: A button in Figma and React with identical properties will have matching stable_ids.", "figma_component": "Figma example: \"content-sha256:d4e5f6...\" - Generated from node type, name, width, height, fills, cornerRadius. Enables linking Figma components to React implementations.", "react_component": "React example: \"content-sha256:h1i2j3...\" - Generated from component name, props signature, structure. Enables linking React components to Figma designs.", "html_element": "HTML example: \"content-sha256:k2l3m4...\" - Generated from tagName, attributes, computed styles. Enables linking HTML elements to design components."}'>
                                    <span class="tree-indent"></span>stable_id <span class="tree-comment">(content-addressable)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf highlight-field" 
                                     data-field="type"
                                     data-examples='{"all": "\"FRAME\"", "figma_component": "\"FRAME\" | \"COMPONENT\" | \"INSTANCE\"", "react_component": "\"FunctionComponent\" | \"ClassComponent\"", "html_element": "\"div\" | \"button\" | \"input\""}'>
                                    <span class="tree-indent"></span><span class="tree-star">type [KEY]</span> <span class="tree-comment">- VARIES BY ARTIFACT_TYPE</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" 
                                     data-field="semantic_type"
                                     data-examples='{"all": "\"button\"", "figma_component": "\"button\" | \"input\" | \"container\"", "react_component": "\"button\" | \"input\" | \"form\"", "html_element": "\"button\" | \"input\" | \"div\""}'>
                                    <span class="tree-indent"></span>semantic_type <span class="tree-comment">(universal: "button", "input", etc.)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>

                                <!-- properties{} -->
                                <div class="tree-node" data-field="properties" data-expandable="true">
                                    <div class="tree-node-header" onclick="toggleNode(this)">
                                        <span class="tree-toggle">▶</span>
                                        <span class="tree-key">properties{}</span>
                                        <span class="tree-comment">(EXTENSIBLE MAP)</span>
                                        <button class="tree-toggle-info" 
                                              data-examples='{"all": "{\"name\": \"Button\", \"width\": 120, \"height\": 40}", "figma_component": "{\"name\": \"Button\", \"width\": 120, \"height\": 40, \"layoutMode\": \"HORIZONTAL\", \"paddingLeft\": 16, \"fills\": [{\"type\": \"SOLID\", \"color\": {\"r\": 0.2, \"g\": 0.4, \"b\": 1}}]}", "react_component": "{\"name\": \"Button\", \"width\": 120, \"height\": 40, \"props\": {\"onClick\": \"handleClick\", \"disabled\": false}, \"hooks\": [\"useState\"]}", "html_element": "{\"name\": \"button\", \"width\": 120, \"height\": 40, \"tagName\": \"button\", \"attributes\": {\"class\": \"btn-primary\", \"type\": \"submit\"}}"}' aria-label="Show information" title="Click to show example">
                                            <span class="info-icon">i</span>
                                        </button>
                                    </div>
                                    <div class="tree-node-children">
                                        <div class="tree-node" data-field="common-props" data-expandable="true">
                                            <div class="tree-node-header" onclick="toggleNode(this)">
                                                <span class="tree-toggle"></span>
                                                <span>COMMON</span> <span class="tree-comment">(all artifact types)</span>
                                            </div>
                                            <div class="tree-node-children">
                                                <div class="tree-leaf" data-field="name" data-examples='{"all": "\"Button\""}'>
                                                    <span class="tree-indent"></span>name
                                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                </div>
                                                <div class="tree-leaf" data-field="width" data-examples='{"all": "120"}'>
                                                    <span class="tree-indent"></span>width
                                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                </div>
                                                <div class="tree-leaf" data-field="height" data-examples='{"all": "40"}'>
                                                    <span class="tree-indent"></span>height
                                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="tree-node" data-field="type-specific-props" data-expandable="true">
                                            <div class="tree-node-header" onclick="toggleNode(this)">
                                                <span class="tree-toggle"></span>
                                                <span>TYPE-SPECIFIC</span> <span class="tree-comment">(depends on artifact_type)</span>
                                            </div>
                                            <div class="tree-node-children">
                                                <!-- Figma-specific -->
                                                <div class="tree-node type-specific-figma" data-field="figma-props" data-expandable="true" data-artifact-type="figma_component">
                                                    <div class="tree-node-header" onclick="toggleNode(this)">
                                                        <span class="tree-toggle"></span>
                                                        <span class="tree-type">IF artifact_type = "figma_component"</span>
                                                    </div>
                                                    <div class="tree-node-children">
                                                        <div class="tree-leaf" data-field="layoutMode" data-examples='{"figma_component": "\"HORIZONTAL\" | \"VERTICAL\" | \"NONE\""}'>
                                                            <span class="tree-indent"></span>layoutMode
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                        <div class="tree-leaf" data-field="padding" data-examples='{"figma_component": "{\"paddingLeft\": 16, \"paddingRight\": 16, \"paddingTop\": 8, \"paddingBottom\": 8}"}'>
                                                            <span class="tree-indent"></span>paddingLeft/Right/Top/Bottom
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                        <div class="tree-leaf" data-field="itemSpacing" data-examples='{"figma_component": "8"}'>
                                                            <span class="tree-indent"></span>itemSpacing
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                        <div class="tree-leaf" data-field="fills" data-examples='{"figma_component": "[{\"type\": \"SOLID\", \"color\": {\"r\": 0.2, \"g\": 0.4, \"b\": 1}}]"}'>
                                                            <span class="tree-indent"></span>fills[]
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                        <div class="tree-leaf" data-field="cornerRadius" data-examples='{"figma_component": "8"}'>
                                                            <span class="tree-indent"></span>cornerRadius
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- React-specific -->
                                                <div class="tree-node type-specific-react" data-field="react-props" data-expandable="true" data-artifact-type="react_component">
                                                    <div class="tree-node-header" onclick="toggleNode(this)">
                                                        <span class="tree-toggle"></span>
                                                        <span class="tree-type">IF artifact_type = "react_component"</span>
                                                    </div>
                                                    <div class="tree-node-children">
                                                        <div class="tree-leaf" data-field="props" data-examples='{"react_component": "{\"onClick\": \"handleClick\", \"disabled\": false, \"children\": \"Click me\"}"}'>
                                                            <span class="tree-indent"></span>props
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                        <div class="tree-leaf" data-field="hooks" data-examples='{"react_component": "[\"useState\", \"useEffect\"]"}'>
                                                            <span class="tree-indent"></span>hooks[]
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                        <div class="tree-leaf" data-field="className" data-examples='{"react_component": "\"btn btn-primary\""}'>
                                                            <span class="tree-indent"></span>className
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                    </div>
                                                </div>
                                                <!-- HTML-specific -->
                                                <div class="tree-node type-specific-html" data-field="html-props" data-expandable="true" data-artifact-type="html_element">
                                                    <div class="tree-node-header" onclick="toggleNode(this)">
                                                        <span class="tree-toggle"></span>
                                                        <span class="tree-type">IF artifact_type = "html_element"</span>
                                                    </div>
                                                    <div class="tree-node-children">
                                                        <div class="tree-leaf" data-field="tagName" data-examples='{"html_element": "\"button\" | \"div\" | \"input\""}'>
                                                            <span class="tree-indent"></span>tagName
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                        <div class="tree-leaf" data-field="attributes" data-examples='{"html_element": "{\"class\": \"btn-primary\", \"type\": \"submit\", \"id\": \"submit-btn\"}"}'>
                                                            <span class="tree-indent"></span>attributes{}
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                        <div class="tree-leaf" data-field="computedStyle" data-examples='{"html_element": "{\"backgroundColor\": \"rgb(0, 102, 255)\", \"padding\": \"8px 16px\"}"}'>
                                                            <span class="tree-indent"></span>computedStyle{}
                                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <!-- spatial{} -->
                                <div class="tree-node" data-field="spatial" data-expandable="true">
                                    <div class="tree-node-header" onclick="toggleNode(this)">
                                        <span class="tree-toggle">▶</span>
                                        <span class="tree-key">spatial{}</span>
                                        <span class="tree-comment">(OPTIONAL - multi-level positioning)</span>
                                        <button class="tree-toggle-info" 
                                              data-examples='{"all": "{\"absolute\": {\"x\": 100, \"y\": 200}, \"relative\": {\"left\": 0, \"top\": 0}}"}' aria-label="Show information" title="Click to show example">
                                            <span class="info-icon">i</span>
                                        </button>
                                    </div>
                                    <div class="tree-node-children">
                                        <div class="tree-leaf" data-field="absolute" data-examples='{"all": "{\"x\": 100, \"y\": 200, \"width\": 120, \"height\": 40}"}'>
                                            <span class="tree-indent"></span>absolute? <span class="tree-comment">(canvas/screen coordinates)</span>
                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                        </div>
                                        <div class="tree-leaf" data-field="relative" data-examples='{"all": "{\"left\": 0, \"top\": 0, \"right\": null, \"bottom\": null}"}'>
                                            <span class="tree-indent"></span>relative? <span class="tree-comment">(layout systems)</span>
                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                        </div>
                                        <div class="tree-leaf" data-field="semantic" data-examples='{"all": "{\"order\": 1, \"hierarchy_level\": 2}"}'>
                                            <span class="tree-indent"></span>semantic? <span class="tree-comment">(hierarchy/order)</span>
                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                        </div>
                                        <div class="tree-leaf" data-field="visual" data-examples='{"all": "{\"bounds\": {\"x\": 100, \"y\": 200, \"width\": 120, \"height\": 40}}"}'>
                                            <span class="tree-indent"></span>visual? <span class="tree-comment">(screenshots/images)</span>
                                            <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                        </div>
                                    </div>
                                </div>

                                <!-- Other optional fields -->
                                <div class="tree-leaf" data-field="visual" data-examples='{"all": "{\"opacity\": 1, \"blendMode\": \"NORMAL\"}"}'>
                                    <span class="tree-indent"></span>visual{} <span class="tree-comment">(optional - rendering properties)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" data-field="text" data-examples='{"all": "{\"content\": \"Click me\", \"fontSize\": 16, \"fontFamily\": \"Inter\"}"}'>
                                    <span class="tree-indent"></span>text{} <span class="tree-comment">(optional - if text element)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" data-field="vector" data-examples='{"all": "{\"pathData\": \"M 0 0 L 100 100\", \"fill\": {...}}"}'>
                                    <span class="tree-indent"></span>vector{} <span class="tree-comment">(optional - if vector element)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" data-field="composition" data-examples='{"all": "{\"children\": [\"child-id-1\", \"child-id-2\"]}"}'>
                                    <span class="tree-indent"></span>composition{} <span class="tree-comment">(optional - if compound element)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" data-field="states" data-examples='{"all": "{\"hover\": {...}, \"active\": {...}, \"disabled\": {...}}"}'>
                                    <span class="tree-indent"></span>states{} <span class="tree-comment">(optional - interaction states)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- relations[] -->
                <div class="tree-node" data-field="relations" data-expandable="true">
                    <div class="tree-node-header" onclick="toggleNode(this)">
                        <span class="tree-toggle">▶</span>
                        <span class="tree-key">relations[]</span>
                        <span class="tree-comment">(Relation edges - EXTENSIBLE LIST)</span>
                        <button class="tree-toggle-info" 
                              data-examples='{"all": "[{\"type\": \"parent_child\", \"from\": \"parent-id\", \"to\": \"child-id\"}]"}' aria-label="Show information" title="Click to show example">
                            <span class="info-icon">i</span>
                        </button>
                    </div>
                    <div class="tree-node-children">
                        <div class="tree-node" data-field="relation-base" data-expandable="true">
                            <div class="tree-node-header" onclick="toggleNode(this)">
                                <span class="tree-toggle">▶</span>
                                <span>Relation (Base)</span>
                            </div>
                            <div class="tree-node-children">
                                <div class="tree-leaf highlight-field" 
                                     data-field="type"
                                     data-examples='{"all": "\"parent_child\" | \"sibling\" | \"uses_token\" | \"instance_of\" | \"renders_to\" | \"derived_from\" | \"exports_to\" | \"compiles_to\""}'>
                                    <span class="tree-indent"></span><span class="tree-star">type [KEY]</span> <span class="tree-comment">- VARIES BY CONTEXT (extensible)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" 
                                     data-field="relation-examples"
                                     data-examples='{"all": "Common: parent_child, sibling, uses_token, instance_of\nDerivation: renders_to (HTML→PNG), derived_from (PNG←HTML), exports_to (Figma→PNG), compiles_to (React→HTML)"}'>
                                    <span class="tree-indent">│  ├─ </span>"parent_child", "sibling", "uses_token", "instance_of"
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" 
                                     data-field="derivation-relations"
                                     data-examples='{"all": "Derivation relations track published artifacts:\n• renders_to: HTML → PNG (rendering)\n• derived_from: PNG ← HTML (reverse)\n• exports_to: Figma → PNG (export)\n• compiles_to: React → HTML (compilation)"}'>
                                    <span class="tree-indent">│  ├─ </span>"renders_to", "derived_from", "exports_to", "compiles_to"
                                    <span class="tree-comment"> (derivation chains)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" 
                                     data-field="custom-relations"
                                     data-examples='{"all": "Add custom relation types as needed"}'>
                                    <span class="tree-indent">│  └─ </span><span class="tree-comment">... (add custom relation types)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" data-field="from" data-examples='{"all": "\"parent-element-id\""}'>
                                    <span class="tree-indent"></span>from <span class="tree-comment">(element ID)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" data-field="to" data-examples='{"all": "\"child-element-id\""}'>
                                    <span class="tree-indent"></span>to <span class="tree-comment">(element ID)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                                <div class="tree-leaf" data-field="properties" data-examples='{"all": "{\"order\": 0, \"constraint\": \"FIXED\"}"}'>
                                    <span class="tree-indent"></span><span class="tree-key">properties{}</span> <span class="tree-comment">(EXTENSIBLE edge metadata)</span>
                                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">i</span></button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- observations{} -->
                <div class="tree-leaf" 
                     data-field="observations"
                     data-examples='{"all": "{\"provenance\": {\"user_id\": \"user-123\", \"tool\": \"figma\", \"extraction_method\": \"figma_plugin_api\"}, \"intent\": {\"source\": \"user_prompt\", \"summary\": \"Create a primary button\"}}"}'>
                    <span class="tree-indent">├─ </span><span class="tree-key">observations{}</span> <span class="tree-comment">(provenance & context)</span>
                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">ℹ</span></button>
                </div>

                <!-- composition_rules{} -->
                <div class="tree-leaf" 
                     data-field="composition_rules"
                     data-examples='{"all": "{\"spacing\": {\"unit\": \"px\", \"scale\": [4, 8, 16]}, \"typography\": {\"baseSize\": 16}}"}'>
                    <span class="tree-indent">├─ </span><span class="tree-key">composition_rules{}</span> <span class="tree-comment">(optional - global layout rules)</span>
                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">ℹ</span></button>
                </div>

                <!-- rendering_manifest{} -->
                <div class="tree-leaf" 
                     data-field="rendering_manifest"
                     data-examples='{"all": "{\"viewport\": {\"width\": 1920, \"height\": 1080}, \"assets\": {\"images\": []}}"}'>
                    <span class="tree-indent">└─ </span><span class="tree-key">rendering_manifest{}</span> <span class="tree-comment">(optional - for reconstruction)</span>
                    <button class="tree-toggle-info" aria-label="Show information" title="Click to show example"><span class="info-icon">ℹ</span></button>
                </div>

            </div>
        </div>
    </div>

    <!-- Tooltip container -->
    <div class="hierarchy-tooltip" id="hierarchy-tooltip">
        <div class="tooltip-header">
            <strong id="tooltip-field-name"></strong>
            <button class="tooltip-close" onclick="hideTooltip()">×</button>
        </div>
        <div class="tooltip-content">
            <div class="tooltip-example-label">Example:</div>
            <pre class="tooltip-example" id="tooltip-example"></pre>
        </div>
    </div>
        </section>
<section id="schema-details" class="section">
    <h1>Schema Details</h1>
    <p class="subtitle">Core field definitions, fidelity targets, and schema versioning</p>

    <!-- Tab Navigation -->
    <div class="tab-container">
        <div class="tab-buttons">
            <button class="tab-btn active" onclick="switchTab(event, 'schema-details', 'core-fields')" aria-label="Core Fields">Core Fields</button>
            <button class="tab-btn" onclick="switchTab(event, 'schema-details', 'fidelity')" aria-label="Fidelity">Fidelity Target</button>
        </div>

        <!-- Core Fields Tab -->
        <div id="schema-details-tab-core-fields" class="tab-content active">
            <h2>Baseline Field Definitions</h2>
            <p>Standard field structures for observations, composition rules, and rendering manifests</p>

            <h3>metadata{} - Core Snapshot Identity</h3>
            <div class="example-box">
                <pre>{
  "metadata": {
    "snapshot_id": "string",           // UUID - unique snapshot identifier
    "artifact_id": "string",           // Global identifier (file, component, page)
    <span class="highlight">"artifact_type": "string",</span>      // Root discriminator: "figma_component", "react_component", etc.
    <span class="highlight">"category": "string",</span>            // OPTIONAL: "published" | "system" | "both"
    "timestamp": number,               // Unix timestamp - ordering only, not identity
    "content_hash": "string",          // Content-addressable hash (sha256)
    "schema_version": "string"         // Systematic: "1.0.0" (same for all adapters)
  }
}</pre>
            </div>

            <h3>observations{} - Provenance & Context</h3>
            <div class="example-box">
                <p>Captures <strong>who</strong>, <strong>when</strong>, <strong>how</strong>, and <strong>why</strong> this snapshot was created.</p>
                <pre>{
  "observations": {
    "provenance": {
      "user_id": "string",
      "user_name": "string",
      "session_id": "string",
      "tool": "string",              // "figma", "vscode", "chrome", etc.
      "tool_version": "string",
      "extraction_method": "string",  // "figma_plugin_api", "babel_ast_parser", etc.
      <span class="highlight">"extractor_version": "string",</span>  // Version of adapter code
      "extracted_at": number,
      "extraction_quality": "string"  // "complete", "partial", "structural_only", etc.
    },
    "intent": {                      // OPTIONAL
      "source": "string",
      "change_type": "string",
      "scope": "string",
      "motivation": "string"
    },
    "context": {                     // OPTIONAL
      "file_name": "string",
      "file_path": "string",
      "page_name": "string",
      "workspace_id": "string"
    }
  }
}</pre>
            </div>

            <h3>composition_rules{} - Component Composition System</h3>
            <div class="example-box">
                <p><strong>Optional field describing how sub-components relate to their parent components and combine into larger structures.</strong> This captures the compositional hierarchy rules - what can nest inside what, how components constrain their children, and the systematic relationships between parts and wholes.</p>
                
                <h4>Key Concept</h4>
                <p>composition_rules{} answers: "How do smaller components combine into larger ones? What are the rules governing parent-child relationships?"</p>
                
                <pre>{
  "composition_rules": {
    "containment": {
      "allowed_children": string[],     // Which component types can be children
      "required_children": string[],    // Which children must be present
      "max_children": number,           // Maximum number of children
      "min_children": number,           // Minimum number of children
      "nesting_depth": number           // How deeply components can nest
    },
    "layout_constraints": {
      "child_arrangement": "string",    // "horizontal" | "vertical" | "grid" | "absolute"
      "child_sizing": "string",         // "fixed" | "fill" | "hug" | "responsive"
      "spacing_between_children": number,
      "padding_for_children": {
        "top": number, "right": number, 
        "bottom": number, "left": number
      }
    },
    "composition_patterns": {
      "type": "string",                 // "list" | "card" | "form" | "nav" | "modal"
      "slot_definitions": [             // Named slots for specific child types
        {
          "name": "string",             // e.g., "header", "body", "footer"
          "allowed_types": string[],    // Which components fit this slot
          "required": boolean
        }
      ]
    },
    "inheritance_rules": {
      "inherits_from": "string",        // Parent component ID
      "overridable_properties": string[],
      "locked_properties": string[]
    }
  }
}</pre>
            </div>

            <h4>Example: Button Component</h4>
            <div class="example-box">
                <pre>{
  "composition_rules": {
    "containment": {
      "allowed_children": ["text", "icon"],
      "max_children": 2,
      "min_children": 1,
      "nesting_depth": 1              // Flat structure, no deep nesting
    },
    "layout_constraints": {
      "child_arrangement": "horizontal",
      "child_sizing": "hug",
      "spacing_between_children": 8,
      "padding_for_children": {
        "top": 12, "right": 20, "bottom": 12, "left": 20
      }
    },
    "composition_patterns": {
      "type": "interactive_element",
      "slot_definitions": [
        {
          "name": "label",
          "allowed_types": ["text"],
          "required": true
        },
        {
          "name": "icon",
          "allowed_types": ["icon", "svg"],
          "required": false
        }
      ]
    }
  }
}</pre>
                <p><strong>What this tells us:</strong> A button can contain 1-2 children (text and/or icon), arranged horizontally with 8px spacing, padded 12px top/bottom and 20px left/right. Children cannot nest further (depth=1).</p>
            </div>

            <h4>Example: Card Component</h4>
            <div class="example-box">
                <pre>{
  "composition_rules": {
    "containment": {
      "allowed_children": ["header", "body", "footer", "image", "text", "button"],
      "required_children": ["body"],
      "max_children": null,            // Unlimited
      "nesting_depth": 3               // Can nest components 3 levels deep
    },
    "composition_patterns": {
      "type": "card",
      "slot_definitions": [
        {
          "name": "header",
          "allowed_types": ["text", "image", "header_component"],
          "required": false
        },
        {
          "name": "body",
          "allowed_types": ["text", "list", "grid", "any"],
          "required": true
        },
        {
          "name": "footer",
          "allowed_types": ["button", "text", "actions"],
          "required": false
        }
      ]
    }
  }
}</pre>
                <p><strong>What this tells us:</strong> A card has optional header/footer slots and a required body slot. It can contain many types of components and allows 3 levels of nesting. The slot system defines where each child type belongs.</p>
            </div>

            <h3>rendering_manifest{} - Visual Reconstruction</h3>
            <div class="example-box">
                <p>Optional blueprint for reconstructing visual appearance from captured data.</p>
                <pre>{
  "rendering_manifest": {
    "viewport": {
      "width": number,
      "height": number,
      "dpr": number,
      "scale": number
    },
    "render_layers": [],
    "assets": {
      "images": [],
      "vectors": [],
      "fonts": []
    },
    "quality": {
      "include_interactions": boolean,
      "include_animations": boolean
    }
  }
}</pre>
            </div>

            <h3>Schema Versioning</h3>
            <div class="example-box">
                <h4>schema_version vs extractor_version</h4>
                <table>
                    <thead>
                        <tr>
                            <th>Field</th>
                            <th>Purpose</th>
                            <th>Scope</th>
                            <th>Example</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td><code>metadata.schema_version</code></td>
                            <td>uDOM specification version</td>
                            <td><strong>Systematic</strong> — same for all adapters</td>
                            <td><code>"1.0.0"</code> (all adapters)</td>
                        </tr>
                        <tr>
                            <td><code>observations.provenance.extractor_version</code></td>
                            <td>Adapter code version — tracks extraction logic</td>
                            <td><strong>Adapter-specific</strong> — varies per adapter</td>
                            <td><code>"figma-adapter-v2.3.1"</code>, <code>"babel-adapter-v1.0.0"</code></td>
                        </tr>
                    </tbody>
                </table>
                <p><strong>Why systematic?</strong> uDOM is a specification. When you see <code>schema_version: "1.0.0"</code>, it means "this snapshot conforms to uDOM schema version 1.0.0." All adapters produce snapshots that conform to the same schema version.</p>
            </div>
        </div>

        <!-- Fidelity Tab -->
        <div id="schema-details-tab-fidelity" class="tab-content">
            <h2>Fidelity Target Derivation</h2>
            <p>Systematic approach to determining visual reconstruction fidelity from extraction metadata</p>

            <h3>What is Fidelity?</h3>
            <div class="example-box">
                <p><strong>Fidelity</strong> refers to how accurately and completely a captured snapshot can reconstruct the original artifact's visual appearance and behavior.</p>
                <ul>
                    <li><strong>Visual Fidelity:</strong> Colors, typography, spacing, shadows, effects</li>
                    <li><strong>Structural Fidelity:</strong> Component hierarchy, layout, relationships</li>
                    <li><strong>Behavioral Fidelity:</strong> Interactions, states, animations</li>
                    <li><strong>Content Fidelity:</strong> Text, images, data accuracy</li>
                </ul>
            </div>

            <h3>Fidelity Levels</h3>
            <table>
                <thead>
                    <tr>
                        <th>Level</th>
                        <th>Description</th>
                        <th>Example Methods</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>wireframe</code></td>
                        <td>Structure only — boxes, hierarchy, basic layout</td>
                        <td>screenshot_ocr, pdf_text_extraction</td>
                    </tr>
                    <tr>
                        <td><code>mockup</code></td>
                        <td>Visual design without interactions — colors, fonts, images</td>
                        <td>figma_rest_api, sketch_json</td>
                    </tr>
                    <tr>
                        <td><code>prototype</code></td>
                        <td>Interactive with states — hover, active, animations</td>
                        <td>figma_plugin_api, react_ast, dom_capture</td>
                    </tr>
                    <tr>
                        <td><code>production</code></td>
                        <td>Pixel-perfect with full behavior and data</td>
                        <td>browser_devtools, figma_export, native_api</td>
                    </tr>
                </tbody>
            </table>

            <h3>Derivation Rules</h3>
            <div class="example-box">
                <p>Fidelity is systematically derived from <code>extraction_method</code> and <code>artifact_type</code>:</p>
                <pre>function deriveFidelity(method, artifactType) {
  // High fidelity methods
  if (["figma_plugin_api", "dom_capture", "browser_devtools"].includes(method)) {
    return "prototype";
  }
  
  // Medium fidelity methods
  if (["figma_rest_api", "babel_ast", "sketch_json"].includes(method)) {
    return "mockup";
  }
  
  // Low fidelity methods
  if (["screenshot_ocr", "pdf_extraction"].includes(method)) {
    return "wireframe";
  }
  
  return "mockup"; // default
}</pre>
            </div>

            <h3>Fidelity by Artifact Type</h3>
            <table>
                <thead>
                    <tr>
                        <th>Artifact Type</th>
                        <th>Typical Fidelity</th>
                        <th>Notes</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>figma_component</code></td>
                        <td>prototype</td>
                        <td>Plugin API captures full visual + interactions</td>
                    </tr>
                    <tr>
                        <td><code>react_component</code></td>
                        <td>mockup</td>
                        <td>AST captures structure but not rendered visuals</td>
                    </tr>
                    <tr>
                        <td><code>html_element</code></td>
                        <td>prototype</td>
                        <td>DOM capture includes computed styles + behavior</td>
                    </tr>
                    <tr>
                        <td><code>png_image</code></td>
                        <td>wireframe</td>
                        <td>OCR/vision models infer structure only</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>
</section>

<section id="examples" class="section">
    <h1>uDOM Examples</h1>
    <p class="subtitle">Concrete examples showing how different artifact types extend the base uDOM schema</p>

    <!-- Tab Navigation -->
    <div class="tab-container">
        <div class="tab-buttons">
            <button class="tab-btn active" onclick="switchExampleTab(event, 'figma')" aria-label="Figma Example">Figma Component</button>
            <button class="tab-btn" onclick="switchExampleTab(event, 'react')" aria-label="React Example">React Component</button>
            <button class="tab-btn" onclick="switchExampleTab(event, 'comparison')" aria-label="Comparison">Comparison</button>
        </div>

        <!-- Figma Example Tab -->
        <div id="example-tab-figma" class="tab-content active">
            <h2>Figma Component Example</h2>
            <p class="subtitle">Complete uDOM structure for a Figma button component showing all extensible fields</p>

            <div class="example-box">
                <pre>{
  "metadata": {
    "snapshot_id": "550e8400-e29b-41d4-a716-446655440000",
    "artifact_id": "figma://file/abc123/node/456",
    "artifact_type": <span class="highlight">"figma_component"</span>, <span class="color-highlight-comment">← Determines schema extensions</span>
    "timestamp": 1704067200000,
    "content_hash": "sha256:a1b2c3...",
    "schema_version": "1.0.0" <span class="color-comment">← Systematic: same for all adapters</span>
  },

  "elements": [
    {
      "id": "123:456",
      "stable_id": "content-sha256:d4e5f6...",
      "type": <span class="highlight">"Component"</span>, <span class="color-highlight-comment">← Figma-specific type</span>
      "semantic_type": "button", <span class="color-comment">← Universal semantic</span>

      "properties": { <span class="color-highlight-comment">← EXTENSIBLE: Figma-specific properties</span>
        "name": "Button/Primary",
        "layoutMode": "HORIZONTAL",
        "paddingLeft": 20,
        "paddingRight": 20,
        "paddingTop": 12,
        "paddingBottom": 12,
        "itemSpacing": 8,
        "cornerRadius": 8,
        "fills": [{"type": "SOLID", "color": {"r": 0.2, "g": 0.4, "b": 0.8}}],
        "effects": [{"type": "DROP_SHADOW", "offset": {"x": 0, "y": 2}}]
      },

      "spatial": {
        "absolute": {
          "coordinate_system": "canvas",
          "bounds": {"x": 100, "y": 200, "width": 120, "height": 40}
        },
        "relative": {
          "layout_mode": "flex",
          "flex": {
            "direction": "row",
            "align": "center",
            "justify": "center"
          }
        }
      },

      "visual": {
        "background": {"type": "solid", "color": "#3366cc"},
        "border_radius": {"tl": 8, "tr": 8, "br": 8, "bl": 8},
        "shadow": [{"x": 0, "y": 2, "blur": 4, "color": "rgba(0,0,0,0.1)"}]
      },

      "composition": {
        "children": ["123:457", "123:458"],
        "layout_mode": "flex"
      }
    },
    {
      "id": "123:457",
      "stable_id": "content-sha256:e5f6g7...",
      "type": "TEXT",
      "semantic_type": "text",
      "properties": {"name": "Label", "fontSize": 16},
      "text": {
        "content": "Click Me",
        "font_family": "Inter",
        "font_size": 16,
        "font_weight": "Medium",
        "line_height": 24
      }
    }
  ],

  "relations": [
    {
      "type": "parent_child",
      "from": "123:456",
      "to": "123:457",
      "properties": {"order": 0}
    }
  ],

  "observations": {
    "provenance": {
      "user_id": "user_123",
      "tool": "figma",
      "extraction_method": "figma_plugin_api",
      "extractor_version": "figma-adapter-v1.0.0",
      "extraction_quality": "complete"
    }
  },

  "composition_rules": {
    "spacing": {
      "vertical_rhythm": {"base_unit": 8},
      "padding": {"left": 20, "right": 20, "top": 12, "bottom": 12}
    }
  }
}</pre>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h4>Key Features</h4>
                    <ul>
                        <li>Visual properties (fills, effects, shadows)</li>
                        <li>Layout system (auto-layout with padding/spacing)</li>
                        <li>Canvas coordinates (absolute positioning)</li>
                        <li>Component hierarchy (parent-child relations)</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Figma-Specific Extensions</h4>
                    <ul>
                        <li><code>layoutMode</code> - HORIZONTAL/VERTICAL/NONE</li>
                        <li><code>fills[]</code> - Array of paint objects</li>
                        <li><code>effects[]</code> - Shadows, blurs, etc.</li>
                        <li><code>cornerRadius</code> - Border radius values</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- React Example Tab -->
        <div id="example-tab-react" class="tab-content">
            <h2>React Component Example</h2>
            <p class="subtitle">Code artifact uDOM showing AST-based extraction without visual properties</p>

            <div class="example-box">
                <pre>{
  "metadata": {
    "snapshot_id": "660e8400-e29b-41d4-a716-446655440111",
    "artifact_id": "repo://github.com/org/project/src/Button.tsx",
    "artifact_type": <span class="highlight">"react_component"</span>,
    "timestamp": 1704070800000,
    "content_hash": "sha256:e7f8g9...",
    "schema_version": "1.0.0" <span class="color-comment">← Systematic: same for all adapters</span>
  },

  "elements": [
    {
      "id": "FunctionComponent:Button",
      "stable_id": "content-sha256:h1i2j3...",
      "type": <span class="highlight">"FunctionComponent"</span>, <span class="color-highlight-comment">← React-specific type</span>
      "semantic_type": "button",

      "properties": { <span class="color-highlight-comment">← React code properties</span>
        "name": "Button",
        "file_path": "src/components/Button.tsx",
        "line_start": 5,
        "line_end": 23,
        "props": {
          "variant": {"type": "string", "default": "primary"},
          "size": {"type": "string", "default": "medium"},
          "onClick": {"type": "function"}
        },
        "hooks": ["useState"],
        "imports": ["React", "styled-components"]
      },

      "composition": {
        "children": ["JSXElement:span", "JSXElement:Icon"],
        "layout_mode": "flex"
      }
    },
    {
      "id": "JSXElement:span",
      "stable_id": "content-sha256:j2k3l4...",
      "type": "JSXElement",
      "semantic_type": "text",
      "properties": {
        "tagName": "span",
        "className": "button-label",
        "children": ["Click Me"]
      }
    }
  ],

  "relations": [
    {
      "type": "parent_child",
      "from": "FunctionComponent:Button",
      "to": "JSXElement:span",
      "properties": {"order": 0}
    }
  ],

  "observations": {
    "provenance": {
      "tool": "babel",
      "extraction_method": "babel_ast_parser",
      "extractor_version": "babel-adapter-v1.0.0",
      "extraction_quality": "complete"
    }
  }
}</pre>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h4>Key Features</h4>
                    <ul>
                        <li>AST-based extraction (no visual properties)</li>
                        <li>Props and type information</li>
                        <li>Hooks and imports tracking</li>
                        <li>File location (line numbers)</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>React-Specific Extensions</h4>
                    <ul>
                        <li><code>props{}</code> - Component prop definitions</li>
                        <li><code>hooks[]</code> - React hooks used</li>
                        <li><code>imports[]</code> - Import statements</li>
                        <li><code>file_path</code> - Source file location</li>
                    </ul>
                </div>
            </div>
        </div>

        <!-- Comparison Tab -->
        <div id="example-tab-comparison" class="tab-content">
            <h2>Cross-Artifact Comparison</h2>
            <p class="subtitle">How different artifact types extend the same base schema</p>

            <table>
                <thead>
                    <tr>
                        <th>Field</th>
                        <th>Figma (figma_component)</th>
                        <th>React (react_component)</th>
                        <th>HTML (html_element)</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>type</code></td>
                        <td>Frame | Component | Instance | Vector | Text</td>
                        <td>FunctionComponent | ClassComponent | JSXElement</td>
                        <td>div | button | input | span | etc.</td>
                    </tr>
                    <tr>
                        <td><code>properties</code></td>
                        <td>layoutMode, paddingLeft/Right/Top/Bottom, fills[], cornerRadius, effects[]</td>
                        <td>props{}, hooks[], state[], className, file_path, line_start</td>
                        <td>tagName, attributes{}, computedStyle{}, classList[], dataset{}</td>
                    </tr>
                    <tr>
                        <td><code>spatial.absolute</code></td>
                        <td><span class="check-yes">✓ Present</span> (canvas coordinates)</td>
                        <td><span class="check-no">✗ Not present</span> (AST, no visual)</td>
                        <td><span class="check-yes">✓ Present</span> (DOM coordinates)</td>
                    </tr>
                    <tr>
                        <td><code>spatial.relative</code></td>
                        <td><span class="check-yes">✓ Present</span> (auto-layout)</td>
                        <td><span class="check-yes">✓ Present</span> (flexbox/CSS Grid inferred)</td>
                        <td><span class="check-yes">✓ Present</span> (CSS layout)</td>
                    </tr>
                    <tr>
                        <td><code>visual</code></td>
                        <td><span class="check-yes">✓ Present</span> (fills, effects, shadows)</td>
                        <td><span class="check-no">✗ Not present</span> (code only)</td>
                        <td><span class="check-yes">✓ Present</span> (computed styles)</td>
                    </tr>
                    <tr>
                        <td><code>text</code></td>
                        <td><span class="check-yes">✓ Present</span> (font properties, content)</td>
                        <td><span class="check-yes">✓ Present</span> (string literals in JSX)</td>
                        <td><span class="check-yes">✓ Present</span> (textContent, font styles)</td>
                    </tr>
                    <tr>
                        <td><code>semantic_type</code></td>
                        <td><span class="check-yes">✓ Universal</span> ("button", "input", "card")</td>
                        <td><span class="check-yes">✓ Universal</span> ("button", "input", "card")</td>
                        <td><span class="check-yes">✓ Universal</span> ("button", "input", "card")</td>
                    </tr>
                    <tr>
                        <td><code>stable_id</code></td>
                        <td><span class="check-yes">✓ Content-addressable</span> (from properties)</td>
                        <td><span class="check-yes">✓ Content-addressable</span> (from AST structure)</td>
                        <td><span class="check-yes">✓ Content-addressable</span> (from DOM structure)</td>
                    </tr>
                </tbody>
            </table>

            <div class="example-box">
                <h3>Key Insights</h3>
                <ul>
                    <li><strong>Universal fields:</strong> <code>semantic_type</code> and <code>stable_id</code> enable cross-artifact matching</li>
                    <li><strong>Platform-specific:</strong> <code>type</code> and <code>properties{}</code> vary by artifact_type</li>
                    <li><strong>Visual vs Code:</strong> Figma and HTML include visual properties; React (AST) does not</li>
                    <li><strong>Same schema, different data:</strong> All artifacts conform to uDOM v1.0.0 but extend via properties{}</li>
                </ul>
            </div>
        </div>
    </div>
</section>

<section id="reference" class="section">
    <h1>Reference Documentation</h1>
    <p class="subtitle">Complete registry of artifact types, extraction methods, and quality guidelines</p>

    <!-- Tab Navigation -->
    <div class="tab-container">
        <div class="tab-buttons">
            <button class="tab-btn active" onclick="switchTab(event, 'reference', 'artifact-types')" aria-label="Artifact Types">Artifact Types</button>
            <button class="tab-btn" onclick="switchTab(event, 'reference', 'extraction-methods')" aria-label="Extraction Methods">Extraction Methods</button>
            <button class="tab-btn" onclick="switchTab(event, 'reference', 'quality')" aria-label="Quality Guide">Quality Guide</button>
        </div>

        <!-- Artifact Types Tab -->
        <div id="reference-tab-artifact-types" class="tab-content active">
            <h2>Complete Artifact Type Registry</h2>
            <p>Supported artifact types with their categories, schemas, and extraction methods</p>

            <div class="filter-buttons">
                <button class="filter-btn active" onclick="filterArtifacts('all', event)">All Types</button>
                <button class="filter-btn" onclick="filterArtifacts('visual', event)">Visual Design</button>
                <button class="filter-btn" onclick="filterArtifacts('code', event)">Code</button>
                <button class="filter-btn" onclick="filterArtifacts('text', event)">Documents</button>
                <button class="filter-btn" onclick="filterArtifacts('workspace', event)">Workspace</button>
            </div>

            <h3>Visual Design Artifacts</h3>
            <table class="artifact-types-table" data-category="visual">
                <thead>
                    <tr>
                        <th>Artifact Type</th>
                        <th>Category</th>
                        <th>Extraction Method</th>
                        <th>Fidelity</th>
                        <th>Schema Extensions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>figma_component</code></td>
                        <td>System</td>
                        <td>figma_plugin_api</td>
                        <td>prototype</td>
                        <td>layoutMode, fills[], effects[], cornerRadius</td>
                    </tr>
                    <tr>
                        <td><code>figma_frame</code></td>
                        <td>System</td>
                        <td>figma_plugin_api</td>
                        <td>prototype</td>
                        <td>auto-layout, constraints, clipsContent</td>
                    </tr>
                    <tr>
                        <td><code>sketch_artboard</code></td>
                        <td>System</td>
                        <td>sketch_json_api</td>
                        <td>mockup</td>
                        <td>layers[], symbols[], styles[]</td>
                    </tr>
                    <tr>
                        <td><code>xd_component</code></td>
                        <td>System</td>
                        <td>xd_plugin_api</td>
                        <td>prototype</td>
                        <td>interactions[], states[], repeat-grid</td>
                    </tr>
                    <tr>
                        <td><code>png_image</code></td>
                        <td>Published</td>
                        <td>screenshot_ocr</td>
                        <td>wireframe</td>
                        <td>width, height, dpi, color_space</td>
                    </tr>
                </tbody>
            </table>

            <h3>Code Artifacts</h3>
            <table class="artifact-types-table" data-category="code">
                <thead>
                    <tr>
                        <th>Artifact Type</th>
                        <th>Category</th>
                        <th>Extraction Method</th>
                        <th>Fidelity</th>
                        <th>Schema Extensions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>react_component</code></td>
                        <td>System</td>
                        <td>babel_ast_parser</td>
                        <td>mockup</td>
                        <td>props{}, hooks[], state[], imports[]</td>
                    </tr>
                    <tr>
                        <td><code>vue_component</code></td>
                        <td>System</td>
                        <td>vue_compiler_api</td>
                        <td>mockup</td>
                        <td>template, script, style, props{}</td>
                    </tr>
                    <tr>
                        <td><code>html_element</code></td>
                        <td>Both</td>
                        <td>dom_capture</td>
                        <td>prototype</td>
                        <td>tagName, attributes{}, computedStyle{}</td>
                    </tr>
                    <tr>
                        <td><code>swift_ui_view</code></td>
                        <td>System</td>
                        <td>swift_ast_parser</td>
                        <td>mockup</td>
                        <td>modifiers[], bindings[], body</td>
                    </tr>
                </tbody>
            </table>

            <h3>Document Artifacts</h3>
            <table class="artifact-types-table" data-category="text">
                <thead>
                    <tr>
                        <th>Artifact Type</th>
                        <th>Category</th>
                        <th>Extraction Method</th>
                        <th>Fidelity</th>
                        <th>Schema Extensions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>pdf_page</code></td>
                        <td>Published</td>
                        <td>pdf_text_extraction</td>
                        <td>wireframe</td>
                        <td>page_number, text_blocks[], annotations[]</td>
                    </tr>
                    <tr>
                        <td><code>markdown_document</code></td>
                        <td>System</td>
                        <td>markdown_ast_parser</td>
                        <td>mockup</td>
                        <td>headings[], code_blocks[], links[]</td>
                    </tr>
                </tbody>
            </table>

            <h3>Workspace Artifacts</h3>
            <table class="artifact-types-table" data-category="workspace" data-workspace="true">
                <thead>
                    <tr>
                        <th>Artifact Type</th>
                        <th>Category</th>
                        <th>Extraction Method</th>
                        <th>Fidelity</th>
                        <th>Schema Extensions</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>figma_file</code></td>
                        <td>System</td>
                        <td>figma_rest_api</td>
                        <td>mockup</td>
                        <td>pages[], components[], styles[]</td>
                    </tr>
                    <tr>
                        <td><code>git_repository</code></td>
                        <td>System</td>
                        <td>git_api</td>
                        <td>structural</td>
                        <td>commits[], branches[], files[]</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Extraction Methods Tab -->
        <div id="reference-tab-extraction-methods" class="tab-content">
            <h2>Extraction Methods Registry</h2>
            <p>Comprehensive list of extraction methods organized by capture layer and application context</p>

            <h3>Design Tools</h3>
            <table>
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Tool</th>
                        <th>Capture Layer</th>
                        <th>Output Category</th>
                        <th>Fidelity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>figma_plugin_api</code></td>
                        <td>Figma</td>
                        <td>Plugin API</td>
                        <td>System</td>
                        <td>prototype</td>
                    </tr>
                    <tr>
                        <td><code>figma_rest_api</code></td>
                        <td>Figma</td>
                        <td>REST API</td>
                        <td>System</td>
                        <td>mockup</td>
                    </tr>
                    <tr>
                        <td><code>sketch_json_api</code></td>
                        <td>Sketch</td>
                        <td>File Format</td>
                        <td>System</td>
                        <td>mockup</td>
                    </tr>
                    <tr>
                        <td><code>xd_plugin_api</code></td>
                        <td>Adobe XD</td>
                        <td>Plugin API</td>
                        <td>System</td>
                        <td>prototype</td>
                    </tr>
                </tbody>
            </table>

            <h3>Code Parsers</h3>
            <table>
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Language/Framework</th>
                        <th>Capture Layer</th>
                        <th>Output Category</th>
                        <th>Fidelity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>babel_ast_parser</code></td>
                        <td>JavaScript/React</td>
                        <td>AST</td>
                        <td>System</td>
                        <td>mockup</td>
                    </tr>
                    <tr>
                        <td><code>vue_compiler_api</code></td>
                        <td>Vue.js</td>
                        <td>AST</td>
                        <td>System</td>
                        <td>mockup</td>
                    </tr>
                    <tr>
                        <td><code>swift_ast_parser</code></td>
                        <td>SwiftUI</td>
                        <td>AST</td>
                        <td>System</td>
                        <td>mockup</td>
                    </tr>
                </tbody>
            </table>

            <h3>Browser/Runtime</h3>
            <table>
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Environment</th>
                        <th>Capture Layer</th>
                        <th>Output Category</th>
                        <th>Fidelity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>dom_capture</code></td>
                        <td>Browser</td>
                        <td>DOM + Computed Styles</td>
                        <td>Both</td>
                        <td>prototype</td>
                    </tr>
                    <tr>
                        <td><code>browser_devtools</code></td>
                        <td>Chrome/Firefox</td>
                        <td>DevTools Protocol</td>
                        <td>Both</td>
                        <td>production</td>
                    </tr>
                </tbody>
            </table>

            <h3>Visual Analysis</h3>
            <table>
                <thead>
                    <tr>
                        <th>Method</th>
                        <th>Input Format</th>
                        <th>Capture Layer</th>
                        <th>Output Category</th>
                        <th>Fidelity</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>screenshot_ocr</code></td>
                        <td>PNG/JPEG</td>
                        <td>Vision + OCR</td>
                        <td>Published</td>
                        <td>wireframe</td>
                    </tr>
                    <tr>
                        <td><code>pdf_text_extraction</code></td>
                        <td>PDF</td>
                        <td>Text Layer</td>
                        <td>Published</td>
                        <td>wireframe</td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Quality Guide Tab -->
        <div id="reference-tab-quality" class="tab-content">
            <h2>Extraction Quality Guide</h2>
            <p>Systematic approach to assessing and declaring extraction quality levels</p>

            <h3>Quality Levels</h3>
            <table>
                <thead>
                    <tr>
                        <th>Level</th>
                        <th>Description</th>
                        <th>Required Fields</th>
                        <th>Use Cases</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>complete</code></td>
                        <td>All relevant data extracted with full fidelity</td>
                        <td>All baseline + visual + spatial</td>
                        <td>Design-to-code, component matching, training data</td>
                    </tr>
                    <tr>
                        <td><code>partial</code></td>
                        <td>Most data extracted, some fields missing or incomplete</td>
                        <td>Baseline + most visual or spatial</td>
                        <td>Exploratory analysis, rough comparisons</td>
                    </tr>
                    <tr>
                        <td><code>structural_only</code></td>
                        <td>Hierarchy and relations captured, visual data limited</td>
                        <td>Baseline + elements + relations</td>
                        <td>Structural analysis, hierarchy visualization</td>
                    </tr>
                    <tr>
                        <td><code>inferred</code></td>
                        <td>Data derived from analysis (OCR, vision models)</td>
                        <td>Baseline + inferred elements</td>
                        <td>Legacy data processing, screenshot analysis</td>
                    </tr>
                </tbody>
            </table>

            <h3>Assessment Criteria</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Completeness</h4>
                    <ul>
                        <li>All elements captured?</li>
                        <li>Relations complete?</li>
                        <li>Visual properties present?</li>
                        <li>Spatial data available?</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Accuracy</h4>
                    <ul>
                        <li>Values match source?</li>
                        <li>Types correctly identified?</li>
                        <li>Relationships accurate?</li>
                        <li>Stable IDs consistent?</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Fidelity</h4>
                    <ul>
                        <li>Can reconstruct original?</li>
                        <li>Visual quality sufficient?</li>
                        <li>Interactions captured?</li>
                        <li>States represented?</li>
                    </ul>
                </div>
            </div>

            <h3>Quality by Method</h3>
            <table>
                <thead>
                    <tr>
                        <th>Extraction Method</th>
                        <th>Typical Quality</th>
                        <th>Limitations</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>figma_plugin_api</code></td>
                        <td>complete</td>
                        <td>None - full API access</td>
                    </tr>
                    <tr>
                        <td><code>babel_ast_parser</code></td>
                        <td>structural_only</td>
                        <td>No rendered visuals, computed styles missing</td>
                    </tr>
                    <tr>
                        <td><code>dom_capture</code></td>
                        <td>complete</td>
                        <td>Dynamic state may vary, animations not captured</td>
                    </tr>
                    <tr>
                        <td><code>screenshot_ocr</code></td>
                        <td>inferred</td>
                        <td>OCR errors, no semantic structure, visual estimation only</td>
                    </tr>
                    <tr>
                        <td><code>figma_rest_api</code></td>
                        <td>partial</td>
                        <td>Some computed values unavailable, no selection state</td>
                    </tr>
                </tbody>
            </table>

            <h3>Declaring Quality</h3>
            <div class="example-box">
                <p>Quality should be declared in <code>observations.provenance.extraction_quality</code>:</p>
                <pre>{
  "observations": {
    "provenance": {
      "extraction_method": "figma_plugin_api",
      "extraction_quality": "complete",
      "quality_notes": "Full API access, all properties captured"
    }
  }
}</pre>
            </div>
        </div>
    </div>
</section>

<section id="data-flow" class="section">
            <h1>Complete System Data Flow</h1>
            <p class="subtitle">End-to-end pipeline from workspace tools to collective database</p>

            <h2>Phase 1: Extraction & Indexing</h2>
            <div class="example-box">
                <p><strong>Each snapshot is indexed by four dimensions:</strong></p>
                <ul>
                    <li><strong>artifact_id</strong> — what thing? (file, document, component)</li>
                    <li><strong>artifact_type</strong> — what platform? (figma_component, react_component, html_dom)</li>
                    <li><strong>capture_context</strong> — how observed? (tool, workspace_id, user_id, extraction_method, adapter_version)</li>
                    <li><strong>timestamp</strong> — when? (ordering only, not identity)</li>
                </ul>
            </div>
            <div class="flow-container">
                <div class="flow-step">
                    <div class="flow-box flow-input">Figma Plugin</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">FigmaAdapter<small>extractor_version: v2.3.1</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">uDOM Snapshot<small>schema_version: "1.0.0"<br/>artifact_type: "figma_component"<br/>capture_context: {...}</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-storage">Snapshot Store<small>(indexed)</small></div>
                </div>
                <div class="flow-step">
                    <div class="flow-box flow-input">VSCode Extension</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">BabelAdapter<small>extractor_version: v1.0.0</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">uDOM Snapshot<small>schema_version: "1.0.0"<br/>artifact_type: "react_component"<br/>capture_context: {...}</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-storage">Snapshot Store<small>(indexed)</small></div>
                </div>
                <div class="flow-step">
                    <div class="flow-box flow-input">Browser Extension</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">DOMAdapter<small>extractor_version: v1.5.2</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">uDOM Snapshot<small>schema_version: "1.0.0"<br/>artifact_type: "html_dom"<br/>capture_context: {...}</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-storage">Snapshot Store<small>(indexed)</small></div>
                </div>
            </div>

            <div class="example-box">
                <p><strong>Key Point:</strong> All adapters produce uDOM snapshots with <code>schema_version: "1.0.0"</code> because they all conform to the same uDOM specification. The adapter code versions (extractor_version) differ, but the schema version is systematic.</p>
            </div>

            <h2>Phase 2: UAT Construction (Derived Views)</h2>
            <div class="example-box">
                <p><strong>UATs are materialized views, not canonical streams.</strong> Multiple UATs can be constructed over the same snapshot pool, aligned along different dimensions.</p>
            </div>

            <div class="db-diagram">
                <div class="db-diagram-horizontal">
                    <!-- Snapshot Store -->
                    <div class="db-table">
                        <div class="db-table-header">snapshots</div>
                        <div class="db-table-columns">
                            <div class="db-column">
                                <span class="db-column-name">snapshot_id</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">artifact_id</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">artifact_type</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">timestamp</span>
                            </div>
                        </div>
                    </div>

                    <div class="db-relationship">
                        <div class="db-relationship-line">
                            <div class="db-relationship-label">Query filtered subset</div>
                            <div class="db-relationship-arrow"></div>
                        </div>
                    </div>

                    <!-- UAT -->
                    <div class="db-table">
                        <div class="db-table-header">uats</div>
                        <div class="db-table-columns">
                            <div class="db-column">
                                <span class="db-column-name">uat_id</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">aligned_artifact_id</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">snapshot_ids</span>
                                <span class="db-column-type">TEXT[]</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">alignment_criteria</span>
                                <span class="db-column-type">TEXT (JSON)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="flow-container">
                <div class="flow-step">
                    <div class="flow-box flow-storage">Snapshot Store</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-decision">Alignment Query<small>e.g., "all figma_component<br/>snapshots for artifact X"</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">UAT Construction</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-storage">UAT Storage<small>(optional, cached views)</small></div>
                </div>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h4>Document Store (PostgreSQL JSONB)</h4>
                    <p>Stores complete uDOM JSON. Flexible schema, fast queries on metadata.</p>
                </div>
                <div class="card">
                    <h4>Columnar Store (Parquet/DuckDB)</h4>
                    <p>Aggregation queries on numeric properties (bounds, sizes, colors). Used for visual artifacts.</p>
                </div>
                <div class="card">
                    <h4>Graph DB (Neo4j)</h4>
                    <p>Stores relations: parent_child, sibling, uses_token, implements. Fast traversal queries.</p>
                </div>
                <div class="card">
                    <h4>Vector Store (pgvector)</h4>
                    <p>Visual embeddings for similarity search. Used for design artifacts with visual properties.</p>
                </div>
            </div>

            <h2>Phase 3: Relations & Derivation Chains</h2>
            <div class="example-box">
                <p><strong>Derivation relationships</strong> track how artifacts transform from system to published forms. These are stored in a separate <code>relations</code> table:</p>
                <ul>
                    <li><strong>renders_to:</strong> HTML → PNG (rendering transformation)</li>
                    <li><strong>derived_from:</strong> PNG ← HTML (reverse relationship)</li>
                    <li><strong>exports_to:</strong> Figma → PNG (export operation)</li>
                    <li><strong>compiles_to:</strong> React → HTML (compilation step)</li>
                </ul>
            </div>
            <div class="flow-container">
                <div class="flow-step">
                    <div class="flow-box flow-udom">HTML Element<small>System / Both</small></div>
                    <div class="flow-arrow">→ <small>renders_to</small></div>
                    <div class="flow-box flow-storage">Relations Table</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">PNG Image<small>Published</small></div>
                </div>
            </div>
            <div class="example-box">
                <p><strong>Query pattern:</strong> Relations enable finding all published artifacts derived from a system artifact, or tracing back to the source of a published artifact.</p>
                <pre>-- Find all PNGs rendered from HTML snapshots
SELECT to_snapshot 
FROM relations 
WHERE type = 'renders_to' 
  AND from_snapshot IN (
    SELECT snapshot_id FROM snapshots 
    WHERE artifact_type = 'html_dom'
  );</pre>
            </div>

            <h2>Phase 4: Aggregation & Query</h2>
            <div class="example-box">
                <p><strong>Multiple contributors' local databases are aggregated into a collective database, then UATs are constructed from filtered subsets.</strong></p>
            </div>
            <div class="flow-container">
                <div class="flow-step">
                    <div class="flow-box flow-storage">Local DBs<small>Multiple contributors<br/>SQLite snapshots</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-decision">Aggregation Layer<small>Cross-artifact links<br/>via stable_id matching</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-storage">Collective DB<small>All snapshots indexed<br/>by contributor, artifact, type</small></div>
                </div>
                <div class="flow-step flow-step-spaced">
                    <div class="flow-box flow-storage">Collective DB</div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-decision">UAT Construction<small>Query filtered subsets<br/>Align by stable_id</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">UATs<small>Materialized views</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-query">Query Layer<small>Datasette / API</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">Agents & Models</div>
                </div>
            </div>

            <div class="example-box">
                <p><strong>Querying with Datasette:</strong> Use SQL to explore snapshots, filter by contributor, artifact type, or extract specific uDOM fields.</p>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h4>Browse Snapshots</h4>
                    <pre># Start Datasette
datasette snapshots.db --port 8000

# Browse in browser:
# http://localhost:8000/snapshots</pre>
                </div>
                <div class="card">
                    <h4>SQL Queries</h4>
                    <pre>-- Find all button components
SELECT * FROM snapshots 
WHERE json_extract(udom_data, 
  '$.elements[0].semantic_type') 
  = 'button';

-- Count by artifact type
SELECT artifact_type, COUNT(*) 
FROM snapshots 
GROUP BY artifact_type;</pre>
                </div>
                <div class="card">
                    <h4>JSON API</h4>
                    <pre># Query via API
curl "http://localhost:8000/snapshots.json\
  ?artifact_type=eq.figma_component\
  &_shape=array"</pre>
                </div>
            </div>

            <h2>Sample User Flow</h2>
            <div class="example-box">
                <pre>DAY 1, 10:00 AM
├─ Designer Alice opens Figma
├─ Plugin Agent connects to Hub
├─ Alice creates Button/Primary (padding: 16px)
│  └─ Snapshot extracted:
│     • artifact_id: "Button/Primary"
│     • artifact_type: "figma_component"
│     • capture_context: {tool: "figma", user_id: "alice", ...}
│     • timestamp: 1704067200000
│  └─ Stored in Snapshot Store
│
DAY 1, 10:15 AM
├─ Alice refines padding 16px → 20px
│  └─ New snapshot extracted (different timestamp, same artifact_id)
│  └─ Stored in Snapshot Store
│
DAY 1, 11:00 AM
├─ Alice adjusts corner radius 4px → 8px
│  └─ Another snapshot extracted
│  └─ Stored in Snapshot Store
│
DAY 2, 2:00 PM
├─ Developer Bob implements Button.tsx
├─ VSCode Extension detects new code
│  └─ Snapshot extracted:
│     • artifact_id: "Button/Primary" (same semantic artifact)
│     • artifact_type: "react_component" (different platform)
│     • capture_context: {tool: "vscode", user_id: "bob", ...}
│  └─ Stored in Snapshot Store
│
DAY 3
├─ Training Pipeline runs
├─ Queries Snapshot Store: "all snapshots for artifact_id='Button/Primary'"
├─ Alignment Layer constructs UAT:
│  └─ figma_component UAT: [snapshot_10am, snapshot_10:15am, snapshot_11am]
│  └─ react_component UAT: [snapshot_2pm]
│  └─ Cross-artifact link via stable_id matching
├─ Learns patterns from aligned snapshots
└─ Also learns: design ↔ code mapping (quality: complete)</pre>
            </div>
        </section><section id="datasette-integration" class="section">
    <h1>How Datasette Fits Into uDOM</h1>
    <p class="subtitle">Datasette serves as the exploration and querying layer for uDOM snapshots, providing instant web UI, SQL interface, and JSON API access to your captured data.</p>

    <h2>Architecture Overview</h2>
    <div class="flow-container">
        <div class="flow-step">
            <div class="flow-box flow-input">Figma Plugin</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-adapter">Artifact Adapter</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-udom">uDOM Snapshot</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-storage">SQLite DB<small>snapshots.db</small></div>
        </div>
        <div class="flow-step flow-step-spaced">
            <div class="flow-box flow-storage">SQLite DB</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-query">Datasette<small>Port 8000<br/>Web UI + SQL + JSON API</small></div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-adapter">Users / Agents / Researchers</div>
        </div>
    </div>

    <div class="example-box">
        <p><strong>Key Point:</strong> Datasette is a <em>read-only exploration layer</em> that sits on top of your SQLite database. It doesn't replace the database — it makes it accessible and queryable.</p>
    </div>

    <h2>Two Deployment Options</h2>
    
    <h3>Option 1: Express Server + Datasette (Current Setup)</h3>
    <div class="flow-container">
        <div class="flow-step">
            <div class="flow-box flow-input">Figma Plugin</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-adapter">POST /snapshots</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-storage">Express Server<small>Port 3000<br/>Write operations</small></div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-storage">SQLite DB</div>
        </div>
        <div class="flow-step flow-step-spaced">
            <div class="flow-box flow-storage">SQLite DB</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-query">Datasette<small>Port 8000<br/>Read operations</small></div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-adapter">Browse / Query / Export</div>
        </div>
    </div>

    <div class="card-grid">
        <div class="card">
            <h4>Express Server (Port 3000)</h4>
            <p><strong>Purpose:</strong> Write operations</p>
            <ul>
                <li>Receives POST requests from plugins</li>
                <li>Validates uDOM snapshots</li>
                <li>Writes to SQLite database</li>
                <li>Provides basic GET endpoints</li>
            </ul>
        </div>
        <div class="card">
            <h4>Datasette (Port 8000)</h4>
            <p><strong>Purpose:</strong> Read operations & exploration</p>
            <ul>
                <li>Web UI for browsing snapshots</li>
                <li>SQL query interface</li>
                <li>JSON API for programmatic access</li>
                <li>Faceted browsing and filtering</li>
                <li>Export capabilities</li>
            </ul>
        </div>
    </div>

    <h3>Option 2: Datasette Only (Future)</h3>
    <div class="flow-container">
        <div class="flow-step">
            <div class="flow-box flow-input">Figma Plugin</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-query">Datasette + Write Plugin<small>Port 8000<br/>Read + Write</small></div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-storage">SQLite DB</div>
        </div>
        <div class="flow-step flow-step-spaced">
            <div class="flow-box flow-storage">SQLite DB</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-query">Datasette<small>Same instance<br/>Web UI + SQL + JSON API</small></div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-adapter">Browse / Query / Export</div>
        </div>
    </div>

    <div class="example-box">
        <p><strong>Migration Path:</strong> Start with Option 1 (Express + Datasette), then migrate to Option 2 using <code>datasette-write</code> plugin when ready. This allows gradual migration without breaking existing integrations.</p>
    </div>

    <h2>What Datasette Provides</h2>

    <div class="card-grid">
        <div class="card">
            <h4>1. Instant Web UI</h4>
            <p>Browse snapshots at <code>http://localhost:8000/snapshots</code>:</p>
            <ul>
                <li>Table view of all snapshots</li>
                <li>Click column headers to sort</li>
                <li>Faceted browsing (filter by artifact_type, timestamp, etc.)</li>
                <li>Click any row to see full uDOM JSON</li>
            </ul>
        </div>
        <div class="card">
            <h4>2. SQL Query Interface</h4>
            <p>Run complex queries directly in the browser:</p>
            <pre>SELECT 
  artifact_id,
  artifact_type,
  json_extract(udom_data, 
    '$.elements[0].semantic_type') 
    as element_type
FROM snapshots
WHERE artifact_type = 'figma_component'
ORDER BY timestamp DESC</pre>
        </div>
        <div class="card">
            <h4>3. JSON API</h4>
            <p>Programmatic access for agents and tools:</p>
            <pre># Get all snapshots
curl "http://localhost:8000/snapshots.json?_shape=array"

# Filter by artifact type
curl "http://localhost:8000/snapshots.json\
  ?artifact_type=eq.figma_component\
  &_shape=array"

# Run custom SQL
curl "http://localhost:8000/snapshots.json\
  ?sql=SELECT+*+FROM+snapshots\
  +LIMIT+10&_shape=array"</pre>
        </div>
        <div class="card">
            <h4>4. Export Capabilities</h4>
            <p>Download data in multiple formats:</p>
            <ul>
                <li>CSV (for spreadsheets)</li>
                <li>JSON (for APIs)</li>
                <li>TSV (tab-separated)</li>
                <li>Custom formats via plugins</li>
            </ul>
        </div>
    </div>

    <h2>Why Datasette?</h2>

    <div class="example-box">
        <p><strong>Datasette is perfect for uDOM because:</strong></p>
        <ul>
            <li><strong>Zero Configuration:</strong> Works directly with SQLite — no schema changes needed</li>
            <li><strong>JSON Support:</strong> Built-in <code>json_extract()</code> for querying nested uDOM fields</li>
            <li><strong>Plugin Ecosystem:</strong> 154+ plugins available (search, visualization, etc.)</li>
            <li><strong>Fast:</strong> Optimized for read-heavy workloads</li>
            <li><strong>Secure:</strong> Built-in SQL injection protection</li>
            <li><strong>Open Source:</strong> MIT licensed, actively maintained</li>
        </ul>
    </div>

    <h2>Practical Use Cases</h2>

    <div class="card-grid">
        <div class="card">
            <h4>For Developers</h4>
            <ul>
                <li>Debug captured snapshots</li>
                <li>Verify extraction quality</li>
                <li>Test SQL queries before coding</li>
                <li>Export data for training models</li>
            </ul>
        </div>
        <div class="card">
            <h4>For Designers</h4>
            <ul>
                <li>Browse captured components</li>
                <li>See what data is being captured</li>
                <li>Verify cross-artifact links</li>
                <li>Understand the uDOM structure</li>
            </ul>
        </div>
        <div class="card">
            <h4>For Researchers</h4>
            <ul>
                <li>Query patterns across snapshots</li>
                <li>Extract training datasets</li>
                <li>Analyze contributor demographics</li>
                <li>Build subgraph queries</li>
            </ul>
        </div>
        <div class="card">
            <h4>For Agents</h4>
            <ul>
                <li>Access via JSON API</li>
                <li>Query by artifact_type, contributor, etc.</li>
                <li>Extract specific uDOM fields</li>
                <li>Discover patterns in data</li>
            </ul>
        </div>
    </div>

    <h2>Example Queries</h2>

    <div class="example-box">
        <h4>Finding Patterns</h4>
        <pre>-- Count snapshots by artifact type
SELECT artifact_type, COUNT(*) as count
FROM snapshots
GROUP BY artifact_type
ORDER BY count DESC;

-- Extract all semantic types used
SELECT DISTINCT
  json_extract(udom_data, 
    '$.elements[0].semantic_type') 
    as semantic_type,
  COUNT(*) as count
FROM snapshots
WHERE json_extract(udom_data, 
  '$.elements[0].semantic_type') 
  IS NOT NULL
GROUP BY semantic_type
ORDER BY count DESC;

-- Find snapshots with specific properties
SELECT 
  artifact_id,
  json_extract(udom_data, 
    '$.elements[0].properties.layoutMode') 
    as layout_mode
FROM snapshots
WHERE artifact_type = 'figma_component'
  AND json_extract(udom_data, 
    '$.elements[0].properties.layoutMode') 
    IS NOT NULL;</pre>
    </div>

    <h2>Setup Instructions</h2>

    <div class="card-grid">
        <div class="card">
            <h4>Quick Start</h4>
            <pre># Install Datasette
pip install datasette

# Run on your SQLite database
cd udom-server
datasette snapshots.db --port 8000 --cors

# Browse at http://localhost:8000</pre>
        </div>
        <div class="card">
            <h4>With Configuration</h4>
            <pre># Use the provided config file
datasette snapshots.db \
  --port 8000 \
  --cors \
  --config datasette-config.yaml

# This enables:
# - Faceted browsing
# - JSON pretty-printing
# - Custom queries
# - Search functionality</pre>
        </div>
        <div class="card">
            <h4>Useful Plugins</h4>
            <pre># Pretty-print JSON columns
pip install datasette-json-html

# Full-text search
pip install datasette-search-all

# Visualizations
pip install datasette-plot

# Enable writes (future)
pip install datasette-write</pre>
        </div>
    </div>

    <h2>Integration with uDOM Workflow</h2>

    <div class="flow-container">
        <div class="flow-step">
            <div class="flow-box flow-input">1. Capture</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-adapter">Figma Plugin captures component</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-udom">uDOM snapshot generated</div>
        </div>
        <div class="flow-step flow-step-spaced">
            <div class="flow-box flow-udom">2. Store</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-adapter">POST to Express server</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-storage">Saved to SQLite</div>
        </div>
        <div class="flow-step flow-step-spaced">
            <div class="flow-box flow-storage">3. Explore</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-query">Open Datasette UI</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-adapter">Browse, query, export</div>
        </div>
        <div class="flow-step flow-step-spaced">
            <div class="flow-box flow-storage">4. Query</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-query">Agents query via Datasette JSON API</div>
            <div class="flow-arrow">→</div>
            <div class="flow-box flow-udom">Access snapshots & UATs<br/>Train models, analyze patterns</div>
        </div>
    </div>

    <div class="example-box">
        <p><strong>Summary:</strong> Datasette doesn't replace your database or adapters — it makes your data <em>accessible</em>. It's the exploration layer that sits between your SQLite database and the users/agents who need to query and understand the captured uDOM snapshots.</p>
    </div>
</section>

<section id="storage-strategy" class="section">
            <h1>Storage Strategy Decision Tree</h1>
            <p class="subtitle">How artifact_type determines which storage backends are used</p>

            <div class="example-box">
                <h3>Decision Criteria</h3>
                <ul>
                    <li><strong>Has visual properties?</strong> (fills, strokes, effects) → Columnar + Vector stores</li>
                    <li><strong>Has spatial data?</strong> (absolute coordinates) → Columnar store for spatial queries</li>
                    <li><strong>Has relational structure?</strong> (parent-child, component hierarchy) → Graph DB</li>
                    <li><strong>Flexible schema needed?</strong> (extensible properties) → Document store (always)</li>
                </ul>
            </div>

            <div class="example-box">
                <p><strong>Blob Storage:</strong> Published artifacts (especially binary outputs like PNG, PDF) require blob storage for the actual binary files, while the uDOM snapshot (structural metadata) is stored in the document/columnar/graph stores.</p>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Artifact Type</th>
                        <th>Category</th>
                        <th>Document</th>
                        <th>Columnar</th>
                        <th>Graph</th>
                        <th>Vector</th>
                        <th>Blob</th>
                        <th>Rationale</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>figma_component</code></td>
                        <td><span class="tag tag-system">System</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-no">✗</span></td>
                        <td>Full visual design: needs all stores, but JSON not binary</td>
                    </tr>
                    <tr>
                        <td><code>react_component</code></td>
                        <td><span class="tag tag-system">System</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-no">✗</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-no">✗</span></td>
                        <td><span class="check-no">✗</span></td>
                        <td>Code AST: no visual properties, no binary output</td>
                    </tr>
                    <tr>
                        <td><code>html_element</code></td>
                        <td><span class="tag tag-both">Both</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-maybe">?</span></td>
                        <td><span class="check-maybe">?</span></td>
                        <td>Can be published (needs blob if rendered to PNG) or system (intermediate)</td>
                    </tr>
                    <tr>
                        <td><code>png_image</code></td>
                        <td><span class="tag tag-published">Published</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-no">✗</span></td>
                        <td><span class="check-no">✗</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td>Published binary: needs blob for image file, vector for visual search</td>
                    </tr>
                    <tr>
                        <td><code>pdf_element</code></td>
                        <td><span class="tag tag-published">Published</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-no">✗</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td>Published document: needs blob for PDF file, spatial queries for layout</td>
                    </tr>
                    <tr>
                        <td><code>sketch_layer</code></td>
                        <td><span class="tag tag-system">System</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-no">✗</span></td>
                        <td>Visual design tool: same as Figma, JSON not binary</td>
                    </tr>
                    <tr>
                        <td><code>screenshot_detection</code></td>
                        <td><span class="tag tag-published">Published</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-no">✗</span></td>
                        <td><span class="check-no">✗</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td><span class="check-yes">✓</span></td>
                        <td>Published visual: needs blob for image, vector for embeddings</td>
                    </tr>
                </tbody>
            </table>

            <h2>Database Schema Diagram</h2>
            <div class="example-box">
                <p><strong>Visual representation of core database tables and their relationships:</strong> This diagram shows how snapshots, contributors, and derivation chains are stored and linked.</p>
            </div>

            <div class="db-diagram">
                <div class="db-diagram-horizontal">
                    <!-- Contributors Table -->
                    <div class="db-table">
                        <div class="db-table-header">contributors</div>
                        <div class="db-table-columns">
                            <div class="db-column">
                                <span class="db-column-name db-column-pk">contributor_id</span>
                                <span class="db-column-type">TEXT PK</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">display_name</span>
                                <span class="db-column-type">TEXT</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">affiliation</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-index">INDEX</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">role</span>
                                <span class="db-column-type">TEXT</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">organization_type</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-index">INDEX</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">share_snapshots</span>
                                <span class="db-column-type">BOOLEAN</span>
                            </div>
                        </div>
                    </div>

                    <!-- Snapshots Table -->
                    <div class="db-table">
                        <div class="db-table-header">snapshots</div>
                        <div class="db-table-columns">
                            <div class="db-column">
                                <span class="db-column-name db-column-pk">snapshot_id</span>
                                <span class="db-column-type">TEXT PK</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">artifact_id</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-index">INDEX</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">artifact_type</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-index">INDEX</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">category</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-type db-column-type-small">(published/system/both)</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">capture_context</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-fk">→ contributor_id</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">timestamp</span>
                                <span class="db-column-type">INTEGER</span>
                                <span class="db-column-index">INDEX</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">udom_data</span>
                                <span class="db-column-type">TEXT (JSON)</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">blob_ref</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-type db-column-type-small">(for published artifacts)</span>
                            </div>
                        </div>
                    </div>

                    <!-- Relations Table -->
                    <div class="db-table">
                        <div class="db-table-header">relations</div>
                        <div class="db-table-columns">
                            <div class="db-column">
                                <span class="db-column-name db-column-pk">relation_id</span>
                                <span class="db-column-type">TEXT PK</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">type</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-type db-column-type-small">(parent_child, renders_to, etc.)</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">from_snapshot</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-fk">→ snapshots</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">to_snapshot</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-fk">→ snapshots</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">properties</span>
                                <span class="db-column-type">TEXT (JSON)</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Relationships -->
                <div class="db-relationship">
                    <div class="db-relationship-line">
                        <div class="db-relationship-label">capture_context.contributor_id</div>
                        <div class="db-relationship-arrow"></div>
                    </div>
                </div>

                <div class="db-relationship">
                    <div class="db-relationship-line">
                        <div class="db-relationship-label">derivation chains (renders_to, derived_from)</div>
                        <div class="db-relationship-arrow"></div>
                    </div>
                </div>
            </div>

            <div class="db-note">
                <strong>Key Relationships:</strong>
                <ul class="list-margin">
                    <li><strong>contributors ↔ snapshots:</strong> Linked via <code>capture_context.contributor_id</code> (stored as JSON in snapshots table)</li>
                    <li><strong>snapshots ↔ relations:</strong> Derivation chains (HTML → PNG) tracked via <code>renders_to</code> / <code>derived_from</code> relation types</li>
                    <li><strong>blob_ref:</strong> Published artifacts (PNG, PDF) reference binary files in blob storage</li>
                </ul>
            </div>

            <h2>Derivation Chain Example</h2>
            <div class="example-box">
                <p><strong>How HTML → PNG derivation is tracked:</strong></p>
            </div>

            <div class="db-diagram">
                <div class="db-diagram-vertical">
                    <!-- HTML Snapshot -->
                    <div class="db-table">
                        <div class="db-table-header">snapshots (HTML)</div>
                        <div class="db-table-columns">
                            <div class="db-column">
                                <span class="db-column-name db-column-pk">snapshot_id</span>
                                <span class="db-column-type">"html_123"</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">artifact_type</span>
                                <span class="db-column-type">"html_element"</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">category</span>
                                <span class="db-column-type">"both"</span>
                            </div>
                        </div>
                    </div>

                    <!-- Relation -->
                    <div class="db-relationship">
                        <div class="db-relationship-line">
                            <div class="db-relationship-label">renders_to</div>
                            <div class="db-relationship-arrow"></div>
                        </div>
                    </div>

                    <!-- PNG Snapshot -->
                    <div class="db-table">
                        <div class="db-table-header">snapshots (PNG)</div>
                        <div class="db-table-columns">
                            <div class="db-column">
                                <span class="db-column-name db-column-pk">snapshot_id</span>
                                <span class="db-column-type">"png_456"</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">artifact_type</span>
                                <span class="db-column-type">"png_image"</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">category</span>
                                <span class="db-column-type">"published"</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">blob_ref</span>
                                <span class="db-column-type">"blob://png_456.bin"</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="db-note">
                <strong>Query Example:</strong> Find all PNG images derived from HTML snapshots:
                <pre class="pre-margin-top">SELECT png.* 
FROM snapshots html
JOIN relations r ON r.from_snapshot = html.snapshot_id
JOIN snapshots png ON r.to_snapshot = png.snapshot_id
WHERE html.artifact_type = 'html_element'
  AND r.type = 'renders_to'
  AND png.artifact_type = 'png_image';</pre>
            </div>
        </section><section id="contributor-architecture" class="section">
            <h1>Contributor Demographics & Subgraph Querying</h1>
            <p class="subtitle">Architecture for managing contributor metadata and querying filtered subsets of the collective database</p>

            <h2>Contributor Demographics Schema</h2>
            <div class="example-box">
                <p><strong>Design Principle:</strong> Contributor demographics are stored separately from snapshots, allowing flexible querying and privacy control. Demographics can be free-text fields (affiliation, role, etc.) or structured metadata.</p>
            </div>

            <h3>Contributor Metadata Table</h3>
            <div class="example-box">
                <pre>CREATE TABLE contributors (
  contributor_id TEXT PRIMARY KEY,
  created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  
  -- Identity (optional, privacy-controlled)
  display_name TEXT,
  email TEXT,  -- Optional, for contact only
  
  -- Demographics (free-text fields)
  affiliation TEXT,      -- e.g., "Stanford University", "Google", "Independent"
  role TEXT,             -- e.g., "Designer", "Researcher", "Student"
  location TEXT,         -- e.g., "San Francisco, CA", "Remote"
  bio TEXT,              -- Free-text bio/description
  
  -- Structured metadata (optional)
  organization_type TEXT,  -- "academic" | "industry" | "independent" | "nonprofit"
  domain_expertise TEXT[], -- Array: ["design_systems", "accessibility", "ml"]
  
  -- Privacy & sharing controls
  share_demographics BOOLEAN DEFAULT true,
  share_snapshots BOOLEAN DEFAULT true,
  share_anonymously BOOLEAN DEFAULT false,
  
  -- Metadata
  metadata JSONB  -- Flexible JSON for additional fields
);

CREATE INDEX idx_affiliation ON contributors(affiliation);
CREATE INDEX idx_organization_type ON contributors(organization_type);
CREATE INDEX idx_share_demographics ON contributors(share_demographics);</pre>
            </div>

            <h3>Snapshot-Contributor Link</h3>
            <div class="example-box">
                <p><strong>Snapshots reference contributors via <code>capture_context.contributor_id</code>:</strong></p>
                <pre>-- In uDOM snapshot:
{
  "observations": {
    "provenance": {
      "contributor_id": "alice_123",  -- Links to contributors table
      "user_id": "alice_figma_456",  -- Tool-specific ID
      ...
    }
  }
}

-- Query pattern:
SELECT 
  s.*,
  c.affiliation,
  c.role,
  c.organization_type
FROM snapshots s
JOIN contributors c ON 
  json_extract(s.capture_context, '$.contributor_id') = c.contributor_id
WHERE c.share_snapshots = true;</pre>
            </div>

            <h2>Subgraph Querying Architecture</h2>
            <div class="example-box">
                <p><strong>Subgraphs are filtered views of the collective database, defined by:</strong></p>
                <ul>
                    <li><strong>Contributor filters:</strong> Demographics (affiliation, role, organization type)</li>
                    <li><strong>Artifact filters:</strong> Type, semantic properties, extraction method</li>
                    <li><strong>Temporal filters:</strong> Date ranges, snapshot sequences</li>
                    <li><strong>Quality filters:</strong> Extraction quality, completeness</li>
                    <li><strong>Privacy filters:</strong> Respecting contributor sharing preferences</li>
                </ul>
            </div>

            <h3>Subgraph Definition</h3>
            <div class="card-grid">
                <div class="card">
                    <h4>Contributor-Based Subgraphs</h4>
                    <pre>-- All snapshots from academic contributors
SELECT s.* FROM snapshots s
JOIN contributors c ON 
  json_extract(s.capture_context, 
    '$.contributor_id') = c.contributor_id
WHERE c.organization_type = 'academic'
  AND c.share_snapshots = true;

-- Contributors from specific affiliation
SELECT s.* FROM snapshots s
JOIN contributors c ON 
  json_extract(s.capture_context, 
    '$.contributor_id') = c.contributor_id
WHERE c.affiliation LIKE '%Stanford%'
  AND c.share_demographics = true;</pre>
                </div>
                <div class="card">
                    <h4>Artifact-Based Subgraphs</h4>
                    <pre>-- All button components
SELECT * FROM snapshots
WHERE json_extract(udom_data, 
  '$.elements[0].semantic_type') = 'button';

-- High-quality Figma components
SELECT * FROM snapshots
WHERE artifact_type = 'figma_component'
  AND json_extract(udom_data, 
    '$.observations.provenance.extraction_quality') 
    = 'complete';</pre>
                </div>
                <div class="card">
                    <h4>Cross-Contributor Patterns</h4>
                    <pre>-- Find similar components across contributors
SELECT 
  json_extract(udom_data, 
    '$.elements[0].semantic_type') as type,
  COUNT(DISTINCT json_extract(capture_context, 
    '$.contributor_id')) as contributor_count,
  COUNT(*) as snapshot_count
FROM snapshots
WHERE artifact_type = 'figma_component'
GROUP BY type
HAVING contributor_count > 1;</pre>
                </div>
            </div>

            <h2>Database Schema: Contributors & Snapshots</h2>
            <div class="db-diagram">
                <div class="db-diagram-horizontal">
                    <!-- Contributors -->
                    <div class="db-table">
                        <div class="db-table-header">contributors</div>
                        <div class="db-table-columns">
                            <div class="db-column">
                                <span class="db-column-name db-column-pk">contributor_id</span>
                                <span class="db-column-type">TEXT PK</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">affiliation</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-index">INDEX</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">role</span>
                                <span class="db-column-type">TEXT</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">organization_type</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-index">INDEX</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">share_snapshots</span>
                                <span class="db-column-type">BOOLEAN</span>
                            </div>
                        </div>
                    </div>

                    <div class="db-relationship">
                        <div class="db-relationship-line">
                            <div class="db-relationship-label">capture_context.contributor_id</div>
                            <div class="db-relationship-arrow"></div>
                        </div>
                    </div>

                    <!-- Snapshots -->
                    <div class="db-table">
                        <div class="db-table-header">snapshots</div>
                        <div class="db-table-columns">
                            <div class="db-column">
                                <span class="db-column-name db-column-pk">snapshot_id</span>
                                <span class="db-column-type">TEXT PK</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">artifact_id</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-index">INDEX</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">artifact_type</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-index">INDEX</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">capture_context</span>
                                <span class="db-column-type">TEXT (JSON)</span>
                                <span class="db-column-fk">→ contributor_id</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">category</span>
                                <span class="db-column-type">TEXT</span>
                                <span class="db-column-index">INDEX</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">blob_ref</span>
                                <span class="db-column-type">TEXT</span>
                            </div>
                            <div class="db-column">
                                <span class="db-column-name">udom_data</span>
                                <span class="db-column-type">TEXT (JSON)</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="db-note">
                <strong>Join Pattern:</strong> Snapshots are linked to contributors via <code>json_extract(snapshots.capture_context, '$.contributor_id') = contributors.contributor_id</code>. This enables filtering snapshots by contributor demographics.
            </div>

            <h2>UAT Construction from Subgraphs</h2>
            <div class="flow-container">
                <div class="flow-step">
                    <div class="flow-box flow-storage">Collective DB<small>All snapshots</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-decision">Subgraph Filter<small>Contributor demographics<br/>Artifact properties<br/>Privacy settings</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">Filtered Snapshot Set<small>Subset matching criteria</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-decision">UAT Construction<small>Align by stable_id<br/>Merge snapshots</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-udom">Subgraph UAT<small>Materialized view</small></div>
                </div>
            </div>

            <div class="example-box">
                <p><strong>Example: Academic Design Systems Subgraph</strong></p>
                <pre>1. Filter contributors:
   WHERE organization_type = 'academic'
     AND share_snapshots = true

2. Filter snapshots:
   WHERE artifact_type = 'figma_component'
     AND json_extract(udom_data, 
       '$.elements[0].semantic_type') 
       IN ('button', 'input', 'card')

3. Construct UAT:
   - Align snapshots by stable_id
   - Merge temporal sequences
   - Preserve contributor attribution

4. Result: UAT containing only academic 
   design system components</pre>
            </div>

            <h2>Query Interface Examples</h2>
            <div class="card-grid">
                <div class="card">
                    <h4>Via Datasette SQL</h4>
                    <pre>-- Academic contributors only
SELECT s.* FROM snapshots s
JOIN contributors c ON 
  json_extract(s.capture_context, 
    '$.contributor_id') = c.contributor_id
WHERE c.organization_type = 'academic'
  AND c.share_snapshots = true
  AND s.artifact_type = 'figma_component';</pre>
                </div>
                <div class="card">
                    <h4>Via API Endpoint</h4>
                    <pre>GET /api/subgraphs/academic-design-systems

Query params:
- contributor_filter: 
  {organization_type: "academic"}
- artifact_filter: 
  {type: "figma_component", 
   semantic_types: ["button", "input"]}
- privacy: true  # Respect sharing settings</pre>
                </div>
                <div class="card">
                    <h4>Via GraphQL (Future)</h4>
                    <pre>query AcademicDesignSystems {
  subgraph(
    contributors: {
      organizationType: "academic"
    }
    artifacts: {
      type: "figma_component"
      semanticTypes: ["button"]
    }
  ) {
    uat {
      snapshots {
        artifact_id
        elements { semantic_type }
      }
    }
  }
}</pre>
                </div>
            </div>

            <h2>Privacy & Sharing Controls</h2>
            <div class="example-box">
                <p><strong>Contributors control what gets shared:</strong></p>
                <ul>
                    <li><strong><code>share_demographics</code>:</strong> Whether affiliation/role appears in queries</li>
                    <li><strong><code>share_snapshots</code>:</strong> Whether snapshots are included in collective DB</li>
                    <li><strong><code>share_anonymously</code>:</strong> Include snapshots but hide contributor_id</li>
                </ul>
            </div>

            <table>
                <thead>
                    <tr>
                        <th>Setting</th>
                        <th>Effect</th>
                        <th>Use Case</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><code>share_demographics = false</code></td>
                        <td>Affiliation/role hidden from queries</td>
                        <td>Privacy-conscious contributors</td>
                    </tr>
                    <tr>
                        <td><code>share_snapshots = false</code></td>
                        <td>Snapshots excluded from collective DB</td>
                        <td>Private/internal work</td>
                    </tr>
                    <tr>
                        <td><code>share_anonymously = true</code></td>
                        <td>Snapshots included but contributor_id hidden</td>
                        <td>Contribute data without attribution</td>
                    </tr>
                </tbody>
            </table>

            <h2>Free-Text Demographics Handling</h2>
            <div class="example-box">
                <p><strong>Since demographics are free-text, use flexible matching:</strong></p>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h4>Fuzzy Matching</h4>
                    <pre>-- Find contributors from universities
SELECT * FROM contributors
WHERE affiliation LIKE '%University%'
   OR affiliation LIKE '%College%'
   OR affiliation LIKE '%Institute%';

-- Use full-text search (SQLite FTS5)
CREATE VIRTUAL TABLE contributors_fts 
USING fts5(affiliation, role, bio);

SELECT * FROM contributors_fts
WHERE contributors_fts MATCH 'Stanford';</pre>
                </div>
                <div class="card">
                    <h4>Normalization (Optional)</h4>
                    <pre>-- Normalize common variations
UPDATE contributors
SET affiliation = 'Stanford University'
WHERE affiliation IN (
  'Stanford', 
  'Stanford U', 
  'Stanford University'
);

-- Or use a normalization table
CREATE TABLE affiliation_normalized (
  raw TEXT,
  normalized TEXT
);</pre>
                </div>
                <div class="card">
                    <h4>LLM-Assisted Categorization</h4>
                    <pre>-- Use LLM to infer organization_type
-- from free-text affiliation
UPDATE contributors
SET organization_type = infer_org_type(affiliation)
WHERE organization_type IS NULL;

-- Example inference:
-- "Stanford University" → "academic"
-- "Google" → "industry"
-- "Independent" → "independent"</pre>
                </div>
            </div>

            <h2>Subgraph Query Patterns</h2>
            <div class="example-box">
                <h4>Common Query Patterns</h4>
                <pre>-- Pattern 1: By Contributor Demographics
SELECT s.* FROM snapshots s
JOIN contributors c ON 
  json_extract(s.capture_context, 
    '$.contributor_id') = c.contributor_id
WHERE c.affiliation LIKE '%Stanford%'
  AND c.share_snapshots = true;

-- Pattern 2: By Artifact Properties
SELECT * FROM snapshots
WHERE artifact_type = 'figma_component'
  AND json_extract(udom_data, 
    '$.elements[0].properties.layoutMode') 
    = 'HORIZONTAL';

-- Pattern 3: Cross-Contributor Analysis
SELECT 
  c.affiliation,
  COUNT(DISTINCT s.snapshot_id) as snapshot_count,
  COUNT(DISTINCT json_extract(s.udom_data, 
    '$.metadata.artifact_id')) as artifact_count
FROM snapshots s
JOIN contributors c ON 
  json_extract(s.capture_context, 
    '$.contributor_id') = c.contributor_id
WHERE c.share_demographics = true
GROUP BY c.affiliation;

-- Pattern 4: Temporal Subgraphs
SELECT * FROM snapshots
WHERE timestamp BETWEEN 
  '2024-01-01' AND '2024-12-31'
  AND json_extract(capture_context, 
    '$.contributor_id') IN (
    SELECT contributor_id FROM contributors
    WHERE organization_type = 'academic'
  );</pre>
            </div>

            <h2>Implementation with Datasette</h2>
            <div class="example-box">
                <p><strong>Datasette makes subgraph querying straightforward:</strong></p>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h4>Pre-defined Views</h4>
                    <pre>-- In datasette-config.yaml
queries:
  academic_snapshots:
    sql: |
      SELECT s.* FROM snapshots s
      JOIN contributors c ON 
        json_extract(s.capture_context, 
          '$.contributor_id') = c.contributor_id
      WHERE c.organization_type = 'academic'
        AND c.share_snapshots = true
  
  design_system_components:
    sql: |
      SELECT * FROM snapshots
      WHERE artifact_type = 'figma_component'
        AND json_extract(udom_data, 
          '$.elements[0].semantic_type') 
          IN ('button', 'input', 'card')</pre>
                </div>
                <div class="card">
                    <h4>Faceted Browsing</h4>
                    <pre>-- Configure facets in Datasette
tables:
  snapshots:
    facets:
      - artifact_type
      - json_extract(udom_data, 
          '$.observations.provenance.extraction_method')
  
  contributors:
    facets:
      - organization_type
      - affiliation  # Free-text, but can facet</pre>
                </div>
            </div>

            <h2>Agent Access to Subgraphs</h2>
            <div class="example-box">
                <p><strong>Agents query subgraphs via UATs:</strong></p>
                <pre>-- Agent requests: "Academic design systems"
1. System filters contributors:
   WHERE organization_type = 'academic'
     AND share_snapshots = true

2. System filters snapshots:
   WHERE artifact_type = 'figma_component'
     AND contributor_id IN (filtered_contributors)

3. System constructs UAT:
   - Aligns snapshots by stable_id
   - Merges temporal sequences
   - Preserves provenance

4. Agent receives UAT:
   - Only academic contributors
   - Only design system components
   - Privacy-respecting</pre>
            </div>

            <div class="card-grid">
                <div class="card">
                    <h4>Subgraph API</h4>
                    <pre>POST /api/subgraphs/construct
{
  "contributor_filters": {
    "organization_type": "academic",
    "affiliation_contains": "Stanford"
  },
  "artifact_filters": {
    "artifact_type": "figma_component",
    "semantic_types": ["button", "input"]
  },
  "privacy": true
}

Response: UAT JSON</pre>
                </div>
                <div class="card">
                    <h4>Query Interface</h4>
                    <pre>-- Via Datasette SQL
SELECT * FROM snapshots s
JOIN contributors c ON 
  json_extract(s.capture_context, 
    '$.contributor_id') = c.contributor_id
WHERE c.organization_type = 'academic'
  AND s.artifact_type = 'figma_component'
  AND json_extract(s.udom_data, 
    '$.elements[0].semantic_type') = 'button';</pre>
                </div>
            </div>
        </section>

<section id="training-use-cases" class="section">
            <h1>Training Use Cases</h1>
            <p class="subtitle">How uDOM/UAT data powers different model architectures and training scenarios</p>

            <table>
                <thead>
                    <tr>
                        <th>Model Type</th>
                        <th>Input</th>
                        <th>Output</th>
                        <th>Dataset Source</th>
                        <th>Architecture</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong>Code ↔ Design (Encoder-Decoder)</strong></td>
                        <td>uDOM (Figma)</td>
                        <td>AST (React)</td>
                        <td>Paired design files + production code with cross-artifact links</td>
                        <td>Transformer encoder-decoder with structural attention</td>
                    </tr>
                    <tr>
                        <td><strong>Accessibility Annotator</strong></td>
                        <td>uDOM (visual)</td>
                        <td>uDOM (with ARIA)</td>
                        <td>Accessibility audits + remediation pairs showing before/after</td>
                        <td>Sequence-to-sequence with semantic role classification</td>
                    </tr>
                    <tr>
                        <td><strong>Component Retrieval</strong></td>
                        <td>uDOM query</td>
                        <td>Similar uDOMs</td>
                        <td>Large design system corpus with visual + structural embeddings</td>
                        <td>Dual encoder (visual + structural) with contrastive learning</td>
                    </tr>
                    <tr>
                        <td><strong>Variant Generator</strong></td>
                        <td>uDOM (base) + variant_axis</td>
                        <td>uDOM (new variant)</td>
                        <td>Component libraries with complete variant families (size/state/theme)</td>
                        <td>Conditional transformer with variant embeddings</td>
                    </tr>
                </tbody>
            </table>

            <h2>Why uDOM Enables Better Models</h2>
            <div class="card-grid">
                <div class="card">
                    <h4>Structural Awareness</h4>
                    <p>Models see component hierarchies, not just pixels. Enables semantic understanding of design intent.</p>
                </div>
                <div class="card">
                    <h4>Temporal Context</h4>
                    <p>UAT diffs show how designs evolve. Models learn design process patterns, not just final states.</p>
                </div>
                <div class="card">
                    <h4>Cross-Artifact Links</h4>
                    <p>Design ↔ code mappings enable bidirectional models. Learn both visual and implementation representations.</p>
                </div>
                <div class="card">
                    <h4>Multi-Level Spatial</h4>
                    <p>Absolute, relative, semantic, and visual coordinates. Models can reason about layout at multiple levels.</p>
                </div>
                <div class="card">
                    <h4>Provenance & Intent</h4>
                    <p>observations{} capture why changes were made. Models can learn user intent and design rationale.</p>
                </div>
                <div class="card">
                    <h4>Unified Schema</h4>
                    <p>Same structure across tools. Models trained on Figma can transfer to Sketch, XD, Framer with minimal adaptation.</p>
                </div>
            </div>
        </section><section id="precedent-schemas" class="section">
            <h1>Precedent Schemas & Standards</h1>
            <p class="subtitle">Comparison of existing standards and models that inform uDOM/UAT design decisions</p>

            <div class="example-box">
                <p>uDOM draws inspiration from many existing standards while addressing gaps for cross-platform, temporal, and agent-friendly artifact representation. This table shows what we adopt, adapt, and extend.</p>
            </div>

            <table id="precedent-schemas-table">
                <thead>
                    <tr>
                        <th>Standard / Model</th>
                        <th>Format</th>
                        <th>What It Is</th>
                        <th>Relevant to uDOM/UAT</th>
                        <th>Gaps for Our Use Case</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td><strong><a href="https://www.w3.org/WAI/ARIA/apg/patterns/" target="_blank" rel="noopener noreferrer">Accessibility Tree</a></strong></td>
                        <td>Platform-specific object trees</td>
                        <td>Semantic view of rendered UI for assistive tech</td>
                        <td>
                            ✅ Shows derived semantic structure<br>
                            ✅ Role/state/property model
                        </td>
                        <td>
                            ❌ Not serializable/transferable<br>
                            ❌ Platform-locked<br>
                            ❌ No temporal dimension
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://www.w3.org/TR/annotation-model/" target="_blank" rel="noopener noreferrer">Web Annotation Data Model</a></strong></td>
                        <td><a href="https://www.w3.org/TR/json-ld11/" target="_blank" rel="noopener noreferrer">JSON-LD</a></td>
                        <td>Standard for attaching annotations to web resources</td>
                        <td>
                            ✅ Fragment selectors<br>
                            ✅ Motivation vocabulary
                        </td>
                        <td>
                            ❌ Not designed for structural changes<br>
                            ❌ Limited to annotation, not full state
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://dom.spec.whatwg.org/" target="_blank" rel="noopener noreferrer">Document Object Model (DOM)</a></strong></td>
                        <td>In-memory (language bindings)</td>
                        <td>Canonical tree for HTML/XML</td>
                        <td>
                            ✅ Node/element/attribute model<br>
                            ✅ Parent-child relations
                        </td>
                        <td>
                            ❌ Not serializable by default<br>
                            ❌ Web-specific<br>
                            ❌ No change tracking
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://www.w3.org/WAI/ARIA/" target="_blank" rel="noopener noreferrer">ARIA</a></strong></td>
                        <td>HTML attributes</td>
                        <td>Accessibility semantics over DOM</td>
                        <td>
                            ✅ Declarative properties<br>
                            ✅ Roles and states
                        </td>
                        <td>
                            ❌ Limited to accessibility<br>
                            ❌ Not comprehensive structural model
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://www.w3.org/TR/prov-o/" target="_blank" rel="noopener noreferrer">PROV-O</a></strong></td>
                        <td><a href="https://www.w3.org/TR/json-ld11/" target="_blank" rel="noopener noreferrer">RDF/OWL (JSON-LD)</a></td>
                        <td>Provenance and derivation over time</td>
                        <td>
                            ✅ Entity-activity-agent model<br>
                            ✅ Temporal relationships
                        </td>
                        <td>
                            ❌ Generic (requires domain extension)<br>
                            ❌ RDF overhead for streams
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://schema.org/" target="_blank" rel="noopener noreferrer">Schema.org</a></strong></td>
                        <td><a href="https://www.w3.org/TR/json-ld11/" target="_blank" rel="noopener noreferrer">JSON-LD</a> / <a href="https://www.w3.org/TR/rdfa-primer/" target="_blank" rel="noopener noreferrer">RDFa</a> / <a href="https://html.spec.whatwg.org/multipage/microdata.html" target="_blank" rel="noopener noreferrer">Microdata</a></td>
                        <td>Shared vocabulary for semantic web</td>
                        <td>
                            ✅ Extensible types<br>
                            ✅ Wide adoption
                        </td>
                        <td>
                            ❌ Content-focused, not structure<br>
                            ❌ No fine-grained UI semantics
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://ogp.me/" target="_blank" rel="noopener noreferrer">Open Graph Protocol</a></strong></td>
                        <td><a href="https://www.w3.org/TR/rdfa-primer/" target="_blank" rel="noopener noreferrer">RDFa</a> / meta tags</td>
                        <td>Social media content metadata</td>
                        <td>
                            ✅ Simple key-value pairs
                        </td>
                        <td>
                            ❌ Only page-level metadata<br>
                            ❌ No structural depth
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://iiif.io/api/presentation/3.0/" target="_blank" rel="noopener noreferrer">IIIF Presentation API</a></strong></td>
                        <td><a href="https://www.w3.org/TR/json-ld11/" target="_blank" rel="noopener noreferrer">JSON-LD</a></td>
                        <td>Standard for image-based resources</td>
                        <td>
                            ✅ Canvas/annotation model<br>
                            ✅ Sequences
                        </td>
                        <td>
                            ❌ Image-centric<br>
                            ❌ Not for interactive artifacts
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://open-services.net/" target="_blank" rel="noopener noreferrer">OSLC (Open Services)</a></strong></td>
                        <td><a href="https://www.w3.org/TR/rdf-syntax-grammar/" target="_blank" rel="noopener noreferrer">RDF/XML</a> or JSON</td>
                        <td>Lifecycle collaboration across tools</td>
                        <td>
                            ✅ Cross-tool linking<br>
                            ✅ Change tracking
                        </td>
                        <td>
                            ❌ Enterprise-heavy<br>
                            ❌ Not design-specific
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://git-scm.com/" target="_blank" rel="noopener noreferrer">Git</a> / Merkle DAGs</strong></td>
                        <td>Binary + delta compression</td>
                        <td>Version control for files</td>
                        <td>
                            ✅ Content-addressable<br>
                            ✅ Diff/merge semantics
                        </td>
                        <td>
                            ❌ File-level, not semantic<br>
                            ❌ Requires domain layer
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://www.openapis.org/" target="_blank" rel="noopener noreferrer">OpenAPI</a> / <a href="https://json-schema.org/" target="_blank" rel="noopener noreferrer">JSON Schema</a></strong></td>
                        <td>JSON/YAML</td>
                        <td>API contracts and data schemas</td>
                        <td>
                            ✅ Extensible schemas<br>
                            ✅ Validation rules
                        </td>
                        <td>
                            ❌ No temporal model<br>
                            ❌ Not spatial/visual
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://www.w3.org/Graphics/SVG/" target="_blank" rel="noopener noreferrer">SVG</a></strong></td>
                        <td>XML</td>
                        <td>Vector graphics format</td>
                        <td>
                            ✅ Structured shapes<br>
                            ✅ Transform model
                        </td>
                        <td>
                            ❌ Static snapshots<br>
                            ❌ No component abstractions
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://www.ecma-international.org/publications-and-standards/standards/ecma-376/" target="_blank" rel="noopener noreferrer">OOXML</a> / <a href="https://www.oasis-open.org/standards#odf" target="_blank" rel="noopener noreferrer">ODF</a></strong></td>
                        <td>ZIP + XML</td>
                        <td>Office document formats</td>
                        <td>
                            ✅ Rich document structure
                        </td>
                        <td>
                            ❌ Format-specific<br>
                            ❌ Complex, not agent-friendly
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://tr.designtokens.org/format/" target="_blank" rel="noopener noreferrer">Design Tokens (W3C)</a></strong></td>
                        <td>JSON</td>
                        <td>Shared design values</td>
                        <td>
                            ✅ Semantic naming<br>
                            ✅ Tool-agnostic
                        </td>
                        <td>
                            ❌ Only for atomic values<br>
                            ❌ No component structure
                        </td>
                    </tr>
                    <tr>
                        <td><strong><a href="https://lottiefiles.com/" target="_blank" rel="noopener noreferrer">Lottie (Bodymovin)</a></strong></td>
                        <td>JSON</td>
                        <td>After Effects animation</td>
                        <td>
                            ✅ Keyframe representation<br>
                            ✅ Time-based sequences
                        </td>
                        <td>
                            ❌ Animation-only<br>
                            ❌ No structural semantics
                        </td>
                    </tr>
                </tbody>
            </table>

            <h2>What uDOM Adds</h2>
            <div class="card-grid">
                <div class="card">
                    <h4>Cross-Platform Structure</h4>
                    <p>Unlike DOM (web-only) or platform-specific trees, uDOM normalizes structure across Figma, React, PDF, PowerPoint, and more.</p>
                </div>
                <div class="card">
                    <h4>Temporal Evolution</h4>
                    <p>UAT provides explicit temporal modeling (unlike static DOM or SVG), enabling design evolution tracking and pattern learning.</p>
                </div>
                <div class="card">
                    <h4>Agent-Friendly</h4>
                    <p>Designed for programmatic consumption (unlike OOXML/ODF complexity), with clear provenance and quality metadata.</p>
                </div>
                <div class="card">
                    <h4>Serializable & Transferable</h4>
                    <p>Unlike in-memory DOM or platform-locked accessibility trees, uDOM is JSON-native and tool-agnostic.</p>
                </div>
                <div class="card">
                    <h4>Compositional Hierarchy</h4>
                    <p>Unlike Design Tokens (atomic values) or Open Graph (page-level), uDOM models full component hierarchies.</p>
                </div>
                <div class="card">
                    <h4>Provenance-Aware</h4>
                    <p>Unlike Git (file-level) or PROV-O (generic), uDOM includes capture-layer provenance specific to design artifacts.</p>
                </div>
            </div>

            <h2>Design Decisions</h2>
            <div class="example-box">
                <h3>Why Not Just Use...</h3>
                <ul>
                    <li><strong>DOM?</strong> Web-specific, not serializable, no temporal model</li>
                    <li><strong>PROV-O?</strong> Too generic, RDF overhead, requires domain extension</li>
                    <li><strong>Schema.org?</strong> Content-focused, lacks UI/design semantics</li>
                    <li><strong>Git?</strong> File-level, not semantic, requires domain layer</li>
                    <li><strong>Design Tokens?</strong> Only atomic values, no component structure</li>
                </ul>
                <p><strong>uDOM combines the best of these:</strong> DOM's tree structure, PROV-O's provenance model, Schema.org's extensibility, Git's content-addressability, and Design Tokens' semantic naming—but applied to cross-platform, temporal, agent-friendly artifact representation.</p>
            </div>
        </section>

<section id="related-work" class="section">
            <h1>Related Work</h1>
            <p class="subtitle">How uDOM relates to existing research and systems</p>

            <div class="example-box">
                <p><strong>uDOM builds on and extends several lines of work:</strong> structural representation (DOM, accessibility trees), provenance tracking (PROV-O), content-addressable systems (Git), design-to-code generation, and embedding inversion research. Unlike prior work, uDOM provides a unified, tool-agnostic, temporally-aware model for structural artifacts with first-class cross-artifact linking and privacy-aware representation learning.</p>
            </div>

            <h2>Key Research Areas</h2>
            <div class="card-grid">
                <div class="card">
                    <h4>Structural Representation</h4>
                    <ul>
                        <li><a href="https://www.w3.org/TR/dom/" target="_blank" rel="noopener noreferrer">Document Object Model (DOM)</a> - Tree model for HTML/XML</li>
                        <li><a href="https://www.w3.org/TR/accname-1.1/" target="_blank" rel="noopener noreferrer">Accessibility Tree</a> - Semantic view of UI</li>
                        <li><a href="https://github.com/facebook/react" target="_blank" rel="noopener noreferrer">React Virtual DOM</a> - Efficient rendering abstraction</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Provenance & Versioning</h4>
                    <ul>
                        <li><a href="https://www.w3.org/TR/prov-o/" target="_blank" rel="noopener noreferrer">PROV-O</a> - W3C provenance ontology</li>
                        <li><a href="https://git-scm.com/" target="_blank" rel="noopener noreferrer">Git</a> - Content-addressable version control</li>
                        <li><a href="https://crdt.tech/" target="_blank" rel="noopener noreferrer">CRDTs</a> - Conflict-free replicated data types</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Design Systems & Standards</h4>
                    <ul>
                        <li><a href="https://design-tokens.github.io/community-group/format/" target="_blank" rel="noopener noreferrer">Design Tokens (W3C)</a> - Shared design values</li>
                        <li><a href="https://storybook.js.org/" target="_blank" rel="noopener noreferrer">Storybook</a> - Component documentation</li>
                    </ul>
                </div>
                <div class="card">
                    <h4>Embedding Inversion & Privacy</h4>
                    <ul>
                        <li><a href="https://github.com/vec2text/vec2text" target="_blank" rel="noopener noreferrer">vec2text</a> - Inverting text embeddings back to text</li>
                        <li><a href="https://arxiv.org/abs/2310.06816" target="_blank" rel="noopener noreferrer">Text Embeddings Reveal (Almost) As Much As Text</a> (EMNLP 2023)</li>
                        <li><a href="https://arxiv.org/abs/2311.13647" target="_blank" rel="noopener noreferrer">Language Model Inversion</a> (ICLR 2024)</li>
                    </ul>
                </div>
            </div>

            <h2>Notable Papers</h2>
            <div class="example-box">
                <h3>Design-to-Code & Cross-Artifact Mapping</h3>
                <ul>
                    <li><a href="https://arxiv.org/abs/2306.12689" target="_blank" rel="noopener noreferrer">Design2Code: How Far Are We From Automating Front-End Engineering?</a> (2023) - Evaluates multimodal LLMs on converting visual designs to code</li>
                    <li><a href="https://dl.acm.org/doi/10.1145/3290605.3300750" target="_blank" rel="noopener noreferrer">Learning to Infer Graphics Programs from Hand-Drawn Images</a> (CHI 2019) - Program synthesis from sketches</li>
                </ul>

                <h3>Component & Pattern Recognition</h3>
                <ul>
                    <li><a href="https://arxiv.org/abs/1705.07962" target="_blank" rel="noopener noreferrer">Rico: A Mobile App Dataset for Building Data-Driven Design Applications</a> (2017) - Large-scale UI dataset with structural annotations</li>
                    <li><a href="https://arxiv.org/abs/2007.06974" target="_blank" rel="noopener noreferrer">Screen2Vec: Semantic Embedding of GUI Screens</a> (2020) - Learning representations of UI screens for retrieval</li>
                </ul>

                <h3>Embedding Inversion & Representation Learning</h3>
                <ul>
                    <li><a href="https://arxiv.org/abs/2310.06816" target="_blank" rel="noopener noreferrer">Text Embeddings Reveal (Almost) As Much As Text</a> (EMNLP 2023) - Shows sentence embeddings can be inverted to recover original text with high fidelity</li>
                    <li><a href="https://arxiv.org/abs/2311.13647" target="_blank" rel="noopener noreferrer">Language Model Inversion</a> (ICLR 2024) - Inverting language model representations, relevant for privacy analysis</li>
                    <li><a href="https://github.com/vec2text/vec2text" target="_blank" rel="noopener noreferrer">vec2text GitHub</a> - Open-source implementation with pre-trained models for inverting OpenAI embeddings</li>
                </ul>

                <h3>Accessibility & Semantic Structure</h3>
                <ul>
                    <li><a href="https://dl.acm.org/doi/10.1145/3290605.3300558" target="_blank" rel="noopener noreferrer">A11y-Coder: Automatic Accessibility Repair</a> (CHI 2019) - Automated accessibility improvements</li>
                </ul>
            </div>

            <h2>Embedding Inversion for uDOM</h2>
            <div class="example-box">
                <p><strong>Privacy considerations for shared embeddings:</strong> Recent work on <a href="https://github.com/vec2text/vec2text" target="_blank" rel="noopener noreferrer">vec2text</a> shows that embeddings can leak significant structural information through inversion attacks. This is relevant for uDOM's contributor architecture.</p>
                
                <h3>Potential Applications</h3>
                <ul>
                    <li><strong>Component Retrieval:</strong> Encode uDOM snapshots → embeddings for similarity search. A "vec2udom" model could invert embeddings back to approximate structures for analysis.</li>
                    <li><strong>Privacy Analysis:</strong> If contributors share uDOM embeddings instead of raw snapshots (for privacy), <a href="https://github.com/vec2text/vec2text" target="_blank" rel="noopener noreferrer">vec2text</a>-style attacks could recover structural details. This affects what can be safely shared.</li>
                    <li><strong>Representation Learning:</strong> Understanding what structural patterns are encoded in uDOM embeddings—similar to how vec2text shows embeddings encode semantic/syntactic information.</li>
                    <li><strong>Design System Probing:</strong> Test what design patterns (layout modes, spacing rules, component hierarchies) are captured in learned embeddings.</li>
                </ul>

                <h3>Future Work</h3>
                <p>As uDOM is used for ML training (especially Component Retrieval and Code ↔ Design models), understanding embedding invertibility will be critical for:</p>
                <ul>
                    <li>Privacy-preserving data sharing (can embeddings leak proprietary designs?)</li>
                    <li>Debugging learned representations (what structural signals are captured?)</li>
                    <li>Similarity search explanation (why did this component match?)</li>
                </ul>
            </div>

            <h2>What uDOM Adds</h2>
            <div class="example-box">
                <ul>
                    <li><strong>Tool-agnostic structure:</strong> Works across Figma, React, HTML, and beyond—not locked to one platform</li>
                    <li><strong>Temporal awareness:</strong> Snapshots + UATs capture evolution, not just static state</li>
                    <li><strong>Cross-artifact linking:</strong> stable_id enables linking components across tools (Figma ↔ React ↔ HTML)</li>
                    <li><strong>Composability separation:</strong> Structural (elements → components) and procedural (actions → workflows) are orthogonal</li>
                    <li><strong>First-class provenance:</strong> Capture context, extraction method, and intent baked into schema</li>
                    <li><strong>Agent-ready:</strong> Designed for streaming (MCP), querying (Datasette), and ML consumption</li>
                    <li><strong>Privacy-aware architecture:</strong> Contributor control over shared data, with consideration for embedding inversion risks</li>
                </ul>
            </div>
        </section>
<section id="visual-diagrams" class="section">
            <h1>Visual Architecture Diagrams</h1>
            <p class="subtitle">Key relationships and data flows in the uDOM system</p>

            <h2>uDOM vs UAT vs DB Relationship</h2>
            <div class="example-box">
                <p><strong>Three-layer architecture:</strong> uDOM snapshots are indexed observations, UATs are derived views, and the DB aggregates across contributors.</p>
            </div>
            
            <div class="db-diagram-container">
                <div class="db-table db-diagram-table">
                    <div class="db-table-header">uDOM Snapshot</div>
                    <div class="db-table-columns">
                        <div class="db-column">
                            <span class="db-column-name">Single artifact</span>
                            <span class="db-column-type">at one time</span>
                        </div>
                        <div class="db-column">
                            <span class="db-column-name">Indexed by</span>
                            <span class="db-column-type">4 dimensions</span>
                        </div>
                        <div class="db-column">
                            <span class="db-column-name">Contains</span>
                            <span class="db-column-type">elements + relations</span>
                        </div>
                    </div>
                </div>
                
                <div class="db-diagram-arrow">
                    <div class="db-diagram-arrow-symbol">→</div>
                    <div class="db-diagram-arrow-label">aligned &<br/>materialized</div>
                </div>
                
                <div class="db-table db-diagram-table">
                    <div class="db-table-header">UAT</div>
                    <div class="db-table-columns">
                        <div class="db-column">
                            <span class="db-column-name">Materialized view</span>
                            <span class="db-column-type">over snapshots</span>
                        </div>
                        <div class="db-column">
                            <span class="db-column-name">Aligned along</span>
                            <span class="db-column-type">chosen axis</span>
                        </div>
                        <div class="db-column">
                            <span class="db-column-name">Multiple UATs</span>
                            <span class="db-column-type">possible</span>
                        </div>
                    </div>
                </div>
                
                <div class="db-diagram-arrow">
                    <div class="db-diagram-arrow-symbol">→</div>
                    <div class="db-diagram-arrow-label">aggregated<br/>across</div>
                </div>
                
                <div class="db-table db-diagram-table">
                    <div class="db-table-header">DB</div>
                    <div class="db-table-columns">
                        <div class="db-column">
                            <span class="db-column-name">Collective</span>
                            <span class="db-column-type">database</span>
                        </div>
                        <div class="db-column">
                            <span class="db-column-name">Multi-contributor</span>
                            <span class="db-column-type">shared</span>
                        </div>
                        <div class="db-column">
                            <span class="db-column-name">Queryable</span>
                            <span class="db-column-type">via Datasette</span>
                        </div>
                    </div>
                </div>
            </div>

            <h2>Contributor Architecture Flow</h2>
            <div class="example-box">
                <p><strong>Multi-contributor system:</strong> Each contributor has their own local database and controls what they share.</p>
            </div>
            
            <div class="flow-container">
                <div class="flow-step">
                    <div class="flow-box">Contributor 1<small>Local DB</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-storage">Share Selected<small>share_snapshots: true</small></div>
                </div>
                <div class="flow-step flow-step-spaced">
                    <div class="flow-box">Contributor 2<small>Local DB</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-storage">Share Selected<small>share_snapshots: true</small></div>
                </div>
                <div class="flow-step flow-step-spaced">
                    <div class="flow-box flow-storage">Collective DB<small>Aggregated</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-query">Subgraph Queries<small>Filter by demographics</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-adapter">Agents & Models</div>
                </div>
            </div>

            <h2>Capture Layer Hierarchy</h2>
            <div class="example-box">
                <p><strong>Capture layers:</strong> From discovery to interaction, each layer adds more detail to the uDOM snapshot.</p>
            </div>
            
            <div class="flow-container flow-container-vertical">
                <div class="flow-step flow-step-full-width">
                    <div class="flow-box flow-box-fixed-width"><span class="tag tag-discovery">Discovery</span><small>Metadata scan</small></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-box-flex"><span class="tag tag-structure">Structure</span><small>Native API / AST</small></div>
                </div>
                <div class="flow-step flow-step-full-width">
                    <div class="flow-box flow-box-fixed-width"><span class="tag tag-structure">Structure</span></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-box-flex"><span class="tag tag-layout">Layout</span><small>Computed positions</small></div>
                </div>
                <div class="flow-step flow-step-full-width">
                    <div class="flow-box flow-box-fixed-width"><span class="tag tag-layout">Layout</span></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-box-flex"><span class="tag tag-vision">Vision</span><small>Screenshots / OCR</small></div>
                </div>
                <div class="flow-step flow-step-full-width">
                    <div class="flow-box flow-box-fixed-width"><span class="tag tag-vision">Vision</span></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-box-flex"><span class="tag tag-text">Text</span><small>Content extraction</small></div>
                </div>
                <div class="flow-step flow-step-full-width">
                    <div class="flow-box flow-box-fixed-width"><span class="tag tag-text">Text</span></div>
                    <div class="flow-arrow"></div>
                    <div class="flow-box flow-box-flex"><span class="tag tag-interaction">Interaction</span><small>Event handlers</small></div>
                </div>
            </div>
            
            <div class="db-note">
                <strong>Note:</strong> Not all layers are required for every artifact type. For example, a React component might only use Structure (AST), while a Figma component uses Structure + Layout + Vision.
            </div>
        </section>

<section id="help" class="section">
    <h1>Help & Support</h1>
    <p class="subtitle">Frequently asked questions and how to get involved</p>

    <h2>Frequently Asked Questions</h2>

    <div class="card-grid">
        <div class="card">
            <h3>What is the difference between uDOM and UAT?</h3>
            <p><strong>uDOM</strong> is a single structural snapshot of an artifact at a point in time. <strong>UAT (Unified Artifact Tree)</strong> is a materialized view constructed from multiple uDOM snapshots, capturing structural evolution over time. UATs are derived from stored snapshots, not directly streamed.</p>
        </div>

        <div class="card">
            <h3>How do I capture snapshots from my design tool?</h3>
            <p>Use an adapter (like the Figma plugin) that extracts structure from your tool. Adapters emit uDOM snapshots that conform to the schema. See the <a href="#" onclick="showSection(event, 'getting-started'); return false;">Getting Started</a> guide for setup instructions.</p>
        </div>

        <div class="card">
            <h3>What is a stable_id and why is it important?</h3>
            <p>A <code>stable_id</code> is a content-addressable identifier derived from element properties (type, name, dimensions, visual properties). Same content = same stable_id across platforms, enabling cross-artifact linking (e.g., linking a Figma component to its React implementation).</p>
        </div>

        <div class="card">
            <h3>Can I use uDOM with tools other than Figma?</h3>
            <p>Yes! uDOM is tool-agnostic. You can build adapters for any design tool (Sketch, Adobe XD), code editors (VS Code), browsers, or other platforms. The schema adapts via <code>artifact_type</code>.</p>
        </div>

        <div class="card">
            <h3>How does authentication work?</h3>
            <p>Authentication is adapter-specific. Each adapter handles its own auth (Figma OAuth, GitHub tokens, etc.). uDOM stores the authentication result in <code>observations.provenance</code>, not credentials.</p>
        </div>

        <div class="card">
            <h3>What's the difference between schema_version and extractor_version?</h3>
            <p><code>schema_version</code> is the uDOM specification version (systematic, same for all adapters). <code>extractor_version</code> is the adapter code version (adapter-specific, tracks extraction logic changes).</p>
        </div>

        <div class="card">
            <h3>How do I query captured snapshots?</h3>
            <p>Use the sample data browser in Getting Started, or install Datasette for a richer experience with SQL queries and JSON API: <code>datasette snapshots.db --port 8000</code></p>
        </div>

        <div class="card">
            <h3>Can I use this for production applications?</h3>
            <p>uDOM is currently in active development. The schema is stabilizing but may evolve. Use for research, prototyping, and exploratory work. Production use should await v1.0.0 release.</p>
        </div>
    </div>

    <h2>Get Involved</h2>

    <div class="card-grid">
        <div class="card">
            <h3>Build Adapters</h3>
            <p>Create adapters for design tools (Sketch, Adobe XD), code editors (VS Code), or browsers. Each adapter extends the ecosystem and enables new use cases.</p>
            <ul>
                <li>See the Figma plugin source for reference implementation</li>
                <li>Follow the schema specification for consistency</li>
                <li>Declare extraction quality honestly</li>
            </ul>
        </div>

        <div class="card">
            <h3>Contribute Data</h3>
            <p>Capture uDOM snapshots from your design workflow and share them (with proper consent) to help build collective datasets for research.</p>
            <ul>
                <li>Use the Figma plugin to capture components</li>
                <li>Anonymize sensitive data</li>
                <li>Document your workflow context</li>
            </ul>
        </div>

        <div class="card">
            <h3>Research Applications</h3>
            <p>Use uDOM for design systems research, ML training, component retrieval, or design-to-code applications.</p>
            <ul>
                <li>Cross-artifact matching via stable IDs</li>
                <li>Training data for vision models</li>
                <li>Design pattern analysis</li>
            </ul>
        </div>

        <div class="card">
            <h3>Improve Documentation</h3>
            <p>Help make these docs clearer, add examples, fix errors, or suggest improvements.</p>
            <ul>
                <li>Submit issues for unclear sections</li>
                <li>Propose new examples</li>
                <li>Share your use cases</li>
            </ul>
        </div>
    </div>

    <h2>Resources</h2>

    <div class="example-box">
        <ul>
            <li><strong>GitHub Repository:</strong> <a href="https://github.com/Taste-AI/hamidah-project" target="_blank" rel="noopener noreferrer">github.com/Taste-AI/hamidah-project</a></li>
            <li><strong>Figma Plugin:</strong> See the <code>figma-plugin/</code> directory</li>
            <li><strong>Sample Data:</strong> Explore via the Getting Started page</li>
            <li><strong>Related Work:</strong> See the Research section for academic context</li>
        </ul>
    </div>

    <h2>Support</h2>

    <div class="example-box">
        <p>For questions, bug reports, or feature requests:</p>
        <ul>
            <li>Open an issue on GitHub</li>
            <li>Check existing issues for similar questions</li>
            <li>Include example snapshots or code when reporting bugs</li>
            <li>Be specific about your use case and context</li>
        </ul>
    </div>
</section>


    </main>
    
    <footer class="footer">
        <p>uDOM Architecture - Universal Structural Knowledge for Design Agents</p>
        <p><a href="https://earnest-lebkuchen-7c5a3e.netlify.app/rl-docs" target="_blank" rel="noopener noreferrer">Taste RL Documentation</a> | <a href="https://github.com/Taste-AI/hamidah-project" target="_blank" rel="noopener noreferrer">GitHub</a></p>
    </footer>
    
    <!-- Floating Action Button -->
    <div class="fab-container">
        <button class="fab-button" onclick="openPluginModal()" aria-label="Get Figma Plugin">
            <span class="fab-tooltip">Get Figma Plugin</span>
            ⬇
        </button>
    </div>
    
    <!-- Plugin Download Modal -->
    <div id="plugin-modal" class="modal-overlay" role="dialog" aria-labelledby="modal-title" aria-hidden="true">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title" id="modal-title">Get Started with uDOM</h2>
                <button class="modal-close" onclick="closePluginModal()" aria-label="Close modal">×</button>
            </div>
            <div class="modal-body">
                <ol class="modal-steps">
                    <li class="modal-step">
                        <h4>Install Dependencies</h4>
                        <p>Navigate to the plugin directory and install packages:</p>
                        <p><code>cd figma-plugin && npm install</code></p>
                    </li>
                    <li class="modal-step">
                        <h4>Build the Plugin</h4>
                        <p>Compile TypeScript to JavaScript:</p>
                        <p><code>npm run build</code></p>
                    </li>
                    <li class="modal-step">
                        <h4>Import to Figma</h4>
                        <p>In Figma: Plugins → Development → Import plugin from manifest → Select <code>manifest.json</code></p>
                    </li>
                    <li class="modal-step">
                        <h4>Start Local Servers</h4>
                        <p>Run the database server: <code>cd udom-server && node server.js</code></p>
                        <p>Run Datasette (optional): <code>datasette snapshots.db --port 8000</code></p>
                    </li>
                </ol>
                
                <div class="modal-note">
                    <strong>Note:</strong> The plugin requires Node.js 16+ and a local database server running on port 3000.
                </div>
                
                <div class="modal-cta">
                    <a href="https://github.com/Taste-AI/hamidah-project" target="_blank" class="btn-primary" aria-label="View uDOM on GitHub">
                        📦 View on GitHub
                    </a>
                    <button class="btn-secondary" onclick="showSection(event, 'plugin-guide'); closePluginModal();" aria-label="Open full plugin guide">
                        Full Guide
                    </button>
                </div>
            </div>
        </div>
    </div>

    <script src="assets/js/script.js"></script>
</body>
</html>